define(["../dashboard/Utils","./PivotLinkComponent.ext","./BaseComponent","../lib/jquery","amd!../lib/jquery.fancybox"],function(t,o,e,n){return e.extend({update:function(){var t=void 0==this.tooltip?"View details in a Pivot table":this.tooltip,o=n('<a class="pivotLink"> </a>').html(this.content).attr("href","javascript:require(['cdf/components/PivotLinkComponent'],function(PivotLinkComponent){PivotLinkComponent.openPivotLink(this.dashboard.getComponent('"+this.name+"'));});void(0);").attr("title",t);n("#"+this.htmlObject).empty(),n("#"+this.htmlObject).html(o),n("a.pivotLink").tooltip({showURL:!1,track:!0,delay:1e3,opacity:.5,content:t})}},{openPivotLink:function(e){var i=o.getPivot("system","pentaho-cdf/actions","jpivot.xaction")+"&",a=e.pivotDefinition;"string"==typeof a.dataSource&&a.dataSource&&(a=n.extend({},e.dashboard.getDataSource(a.dataSource),a),delete a.dataSource);var c=[];for(var s in a)a.hasOwnProperty(s)&&c.push(s+"="+encodeURIComponent(t.ev(a[s])));i+=c.join("&"),i=i.replace(/'/g,"&#39;"),n.fancybox.open({src:i,type:"iframe",baseClass:"cdf-fancybox cdf-fancybox-iframe",btnTpl:{smallBtn:'<button type="button" data-fancybox-close class="fancybox-button fancybox-close-small" title="close"></button>'}},{toolbar:!1,smallBtn:!0,iframe:{preload:!1,css:{width:n(window).width(),height:n(window).height(),"max-width":"100%","max-height":"100%"}}})}})});