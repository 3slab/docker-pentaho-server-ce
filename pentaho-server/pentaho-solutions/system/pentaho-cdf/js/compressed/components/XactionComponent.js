define(["./XactionComponent.ext","../lib/jquery","./BaseComponent","../dashboard/Utils"],function(t,e,i,a){return i.extend({update:function(){var i=this;try{if(void 0!==this.iframe&&this.iframe){for(var s='<iframe id="iframe_'+this.htmlObject+'" frameborder="0" height="100%" width="100%" />',n=e(s),h=a.pathIncludesAction(this.path,this.action)?"":this.action||"",r=t.getCdfXaction(this.path,h,this.solution)+"&wrapper=false",o=new Array(this.parameters.length),d=0,l=o.length;d<l;d++){var c="&"+encodeURIComponent(this.parameters[d][0])+"=",m="";""==this.parameters[d][1]?m=encodeURIComponent(this.parameters[d][2]):"NIL"==(m=encodeURIComponent(this.dashboard.getParameterValue(this.parameters[d][1])))&&(m=encodeURIComponent(this.parameters[d][2])),r+=c+m}this.loading||(this.loading=!0,this.dashboard.incrementRunningCalls()),n.on("load",function(){this.contentWindow.document.body.innerHTML&&(i.loading=!1,i.dashboard.decrementRunningCalls())}),e("#"+this.htmlObject).empty().append(n),n[0].contentWindow.location=r}else{for(var o=new Array(this.parameters?this.parameters.length:0),d=0,l=o.length;d<l;d++){var p=this.parameters[d][0],u=""==this.parameters[d][1]?this.parameters[d][2]:this.dashboard.getParameterValue(this.parameters[d][1]);"NIL"==this.value&&(this.value=this.parameters[d][2]),o[d]=[p,u]}if(void 0===this.serviceMethod||"ServiceAction"==this.serviceMethod){var f=this.dashboard.callPentahoAction(i,this.solution,this.path,this.action,o,null);null!=f&&e("#"+i.htmlObject).html(f.find("ExecuteActivityResponse:first-child").text())}else{var v=this.dashboard.pentahoServiceAction(this.serviceMethod,"html",this.solution,this.path,this.action,o,null);e("#"+i.htmlObject).html(v)}}}catch(t){}}})});