define(["./XactionComponent.ext","../lib/jquery","./BaseComponent","amd!../lib/jquery.fancybox"],function(t,e,a){return a.extend({visible:!1,update:function(){var t=this,a=this.placeholder();a[0]&&e.inArray(a[0].tagName.toUpperCase(),["SPAN","DIV"])>-1&&(a=e("<button/>").appendTo(a.empty()),"DIV"==a[0].tagName&&a.wrap("<span/>"),void 0!=this.label&&a.text(this.label),a.button()),a.unbind("click"),a.bind("click",function(){(void 0===t.preChange||t.preChange())&&t.executeXAction(),void 0!==t.postChange&&t.postChange()})},executeXAction:function(){for(var a=t.getCdfXaction(this.path,this.action,this.solution)+"&",n=new Array(this.parameters.length),o=[],i=0,s=n.length;i<s;i++){var c=this.parameters[i][0],r=this.dashboard.getParameterValue(this.parameters[i][1]);e.isArray(r)?e(r).each(function(t){o.push(c+"="+encodeURIComponent(this))}):o.push(c+"="+encodeURIComponent(r))}a+=o.join("&"),a=a.replace(/'/g,"&#39;"),e.fancybox.open({src:a,type:"iframe",baseClass:"cdf-fancybox cdf-fancybox-iframe",btnTpl:{smallBtn:'<button type="button" data-fancybox-close class="fancybox-button fancybox-close-small" title="close"></button>'}},{toolbar:!1,smallBtn:!0,iframe:{preload:!1,css:{width:e(window).width(),height:e(window).height()-50,"max-width":"100%","max-height":"100%"}}})}})});