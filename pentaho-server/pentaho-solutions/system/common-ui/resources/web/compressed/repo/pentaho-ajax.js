/*!
* Copyright 2010 - 2019 Hitachi Vantara.  All rights reserved.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
*/

var COMPLETE=4,STATUS_OK=200,STATUS_UNAUTHORIZED=401,STATUS_NOT_FOUND=404,base="",pathArray=window.location.pathname.split("/"),webAppPath="/"+pathArray[1];!function(window){var pentahoAjax={};pentahoAjax.pentahoAction=window.pentahoAction=function(e,t,n,o,a){var r=pentahoAjax.getViewActionUrlAndQuery(e,t,n,o),i=r.url,c=r.query;return pentahoAjax.pentahoPost(i,c,a)},pentahoAjax.getViewActionUrl=window.getViewActionUrl=function(e,t,n,o){var a=pentahoAjax.getViewActionUrlAndQuery(e,t,n,o);return a.url+"?"+a.query},pentahoAjax.getViewActionUrlAndQuery=window.getViewActionUrlAndQuery=function(e,t,n,o){var a=(o||[]).concat([["wrapper","false"],["solution",e],["path",t],["action",n]]);return{url:CONTEXT_PATH+"ViewAction",query:buildQueryParams(a)}},pentahoAjax.pentahoService=window.pentahoService=function(e,t,n,o){var a=(t||[]).concat([["ajax","true"],e?["component",e]:void 0]),r=FULL_QUALIFIED_URL+"ServiceAction",i=pho.csrfUtil.getToken(r),c=buildQueryParams(a);return pentahoAjax.pentahoPost(r,c,n,o,i)},pentahoAjax.pentahoGet=window.pentahoGet=function(e,t,n,o,a,r){var i=createXhr(o,n),c=isAsyncRequest(n);if(!0!==a){var u=(new Date).getTime();t=t+(0===t.length?"":"&")+u+"="+u}return i.open("GET",e+"?"+t,c),null!=r&&i.setRequestHeader(r.header,r.token),i.send(null),c?null:pentahoAjax.getResponse(i)},pentahoAjax.getUnauthorizedMsg=window.getUnauthorizedMsg=function(){return"<web-service><unauthorized/></web-service>"},pentahoAjax.getNotFoundMsg=window.getNotFoundMsg=function(){return"<web-service><not-found/></web-service>"},pentahoAjax.pentahoPost=window.pentahoPost=function(e,t,n,o,a){var r=createXhr(o,n),i=isAsyncRequest(n);return r.open("POST",e,i),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),null!=a&&r.setRequestHeader(a.header,a.token),r.send(t),i?null:pentahoAjax.getResponse(r)},pentahoAjax.pentahoResponse=window.pentahoResponse=function(http_request,callback){if(http_request.readyState===COMPLETE)try{var content=pentahoAjax.getResponse(http_request);if("function"==typeof callback)callback(content);else if("object"==typeof callback&&void 0!=callback.obj)callback.method.call(callback.obj,content);else{if("string"!=typeof callback)throw new Error("Invalid state in pentahoResponse, unrecognized callback function.");eval(callback+"( content );")}}catch(e){throw alert("pentaho-ajax.js.pentahoResponse(): "+e),e}},pentahoAjax.getResponse=window.getResponse=function(e){switch(e.status){case STATUS_OK:return e.responseText;case STATUS_UNAUTHORIZED:return pentahoAjax.getUnauthorizedMsg();case STATUS_NOT_FOUND:return pentahoAjax.getNotFoundMsg();default:return null}};var createXhr=function(e,t){var n=null;if(window.XMLHttpRequest){if(n=new XMLHttpRequest,n.overrideMimeType){var o="text/xml";e&&(o=e),n.overrideMimeType(o)}}else if(window.ActiveXObject)try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}if(null==n)throw new Error("Cannot create XMLHTTP instance");return isAsyncRequest(t)&&(n.onreadystatechange=function(){pentahoResponse(n,t)}),n},buildQueryParams=function(e){if(null==e)return"";for(var t=[],n=0,o=e.length;n<o;n++){var a=e[n];null!=a&&t.push(encodeURIComponent(a[0])+"="+encodeURIComponent(a[1]))}return t.join("&")},isAsyncRequest=function(e){return null!=e};define("common-repo/pentaho-ajax",["common-ui/util/pentaho-csrf"],function(){return pentahoAjax}),define("common-ui/repo/pentaho-ajax",["common-ui/util/pentaho-csrf"],function(){return pentahoAjax})}(window);