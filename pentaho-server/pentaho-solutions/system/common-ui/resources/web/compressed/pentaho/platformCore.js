/*!
 * Copyright 2010 - 2017 Hitachi Vantara. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*!
 * Copyright 2010 - 2019 Hitachi Vantara. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.1.1
 */

/*!
 * Copyright 2010 - 2019 Hitachi Vantara.  All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*!
 * Copyright 2016 - 2017 Hitachi Vantara. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*!
 * Based on Generic.js 1.1a (c) 2006-2010, Dean Edwards
 * Updated to pass JSHint and converted into a module by Kenneth Powers
 * License: http://www.opensource.org/licenses/mit-license.php
 */

/*!
 * Based on Generic.js by Dean Edwards, and later edited by Kenneth Powers.
 *
 * Changes:
 * 1. Added support for the `instanceof` operator.
 * 2. Added support for ES5 get/set properties.
 * 3. Added support for "Array classes", through `Base.Array`.
 * 4. Improved support for mixins.
 *
 *    Namely, it is now possible to call the mixed-in class constructor
 *    to initialize an instance of another class.
 *
 * 5. `Class.init` was removed.
 * 6. Added the `Class.to` method.
 *
 *    Converts its arguments to an instance of `Class`, or throws if that is impossible.
 *
 *    The default implementation tests if the first argument is an instance of that type and returns it, if it is.
 *    Otherwise, it calls `Class` with the `new` operator and all of the given arguments and returns the result.
 *
 * 7. To support 4., the previous constructor behavior, for when invoked
 *    on a non-instance of it (possibly without using the `new` operator) was dropped.
 *    It would extend the first argument with the class' prototype.
 *    Now, it ends up initializing the global object...
 * 8. Removed `Class#forEach`.
 * 9. Instances no longer have an own "base" property,
 *    it is inherited from, and set on, the corresponding "Base" root prototype object.
 * 10. `Base._prototyping` and `Base#_constructing` are no longer needed to
 *     control Class constructor and inst_extend flow.
 * 11. Class.valueOf removed. No longer needed... ?
 * 12. `Base#__base_root_proto__` is a new constant, non-enumerable property, set at each "Base" root prototype.
 * 13. `Base#__base_init__` is a new constant, non-enumerable, property, set at the prototype of "Base" classes
 *     that have an own initialization method (specified with the `constructor` property).
 * 14. Added new Class.implementStatic method to allow to specify the class interface after extend.
 *     Is parallel to Class.implement.
 * 15. Any existing static methods are inherited (not only standard Base ones).
 * 16. Dropped support for the overload Base#extend(name, value).
 *     The same method now supports only the signature Base#extend(instSpec[, keyArgs]).
 * 17. Added support to augment the set of per-class, inherited property names that are excluded from
 *     instance-extension operations.
 *     Specify `extend_exclude` when sub-classing, e.g. `Base.extend({extend_exclude: {a: true, b: true}});`.
 * 18. Added support to control, per-class, the properties extension order in instance-extension operations.
 *     Specify `extend_order` when sub-classing, e.g. `Base.extend({extend_order: ["b", "a"]});`.
 */

/*!
 * Copyright 2018 Hitachi Vantara. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*!
 * Copyright 2018 - 2019 Hitachi Vantara. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*!
 * Copyright 2019 Hitachi Vantara. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*!
 * Copyright 2017-2018 Hitachi Vantara. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*!
 * Copyright 2010 - 2018 Hitachi Vantara. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

define("pentaho/util/has",[],function(){"use strict";function e(e){return t.call(i,e)&&!!i[e]}var t=Object.prototype.hasOwnProperty,n=!1;if("undefined"!=typeof URL)try{var r=new URL("b","http://a");r.pathname="c%20d",n="http://a/c%20d"===r.href}catch(e){}var i={"Object.setPrototypeOf":null!=Object.setPrototypeOf,"Object.prototype.__proto__":null!={}.__proto__,URL:n};return e}),define("pentaho/util/object",["./has"],function(e){"use strict";function t(e,t){var n=e[m];return null==n&&(t?(n="i"+y++,r(e,m,n)):n=null),n}function n(e,t){var n;for(var r in t)h.call(t,r)&&void 0!==(n=t[r])&&(e[r]=n);return e}function r(e,t,n){_.value=n,Object.defineProperty(e,t,_),_.value=void 0}function i(e,t,n){var r=o(t,n);return(r&&r.get||r.set||void 0!==r.value)&&Object.defineProperty(e,n,r),e}function o(e,t,n){for(var r;!(r=Object.getOwnPropertyDescriptor(e,t))&&(e=Object.getPrototypeOf(e))&&(!n||e!==n););return r||null}function u(e,t){return e.__proto__=t,e}function s(e,t){for(var n in t)i(e,t,n);return e}function a(e){return null==e?"":e}function l(e){return null==e?"":e.toString()}function c(e){return null==e?"":e.toISOString()}function f(e){if(null==e)return"";switch(typeof e){case"string":return e;case"number":case"boolean":return e.toString()}return e instanceof Date?e.toISOString():t(e,!0)}var h=Object.prototype.hasOwnProperty,d=[],p=e("Object.setPrototypeOf")?Object.setPrototypeOf:e("Object.prototype.__proto__")?u:s,_={value:void 0,writable:!1,configurable:!1,enumerable:!1},g=Object.prototype,v=Object.prototype.isPrototypeOf,m="___OBJUID___",y=1;return{delete:function(e,t,n){var r=n;return e&&t in e&&(r=e[t],delete e[t]),r},using:function(e,t,n){try{return t.call(n,e)}finally{e.dispose()}},hasOwn:function(e,t){return!!e&&h.call(e,t)},getOwn:function(e,t,n){return e&&h.call(e,t)?e[t]:n},setConst:r,eachOwn:function(e,t,n){for(var r in e)if(h.call(e,r)&&!1===t.call(n||e,e[r],r))return!1;return!0},assignOwn:function(e,t){for(var n in t)h.call(t,n)&&(e[n]=t[n]);return e},assignOwnDefined:n,cloneShallow:function(e){return e&&"object"==typeof e&&(e instanceof Array?e=e.slice():e.constructor===Object&&(e=n({},e))),e},getPropertyDescriptor:o,lca:function(e,t){if(!e||!t)return null;for(var n=t;e!==n&&n!==g&&!v.call(n,e)&&(n=Object.getPrototypeOf(n)););return n!==g||v.call(n,e)||(n=null),n},make:function(e,t){switch(t?t.length:0){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2])}var n=Object.create(e.prototype);return e.apply(n,t)||n},setPrototypeOf:p,applyClass:function(e,t,n){var r=t.prototype;return r===e||r.isPrototypeOf(e)?e:(p(e,r),e.constructor!==t&&Object.defineProperty(e,"constructor",{configurable:!0,writable:!0,value:t}),t.apply(e,n||d)||e)},getUniqueId:t,getSameTypeKey:f,getSameTypeKeyFun:function(e){switch(e){case"string":return a;case"number":case"boolean":return l;case"date":return c;default:return f}}}}),define("pentaho/util/fun",[],function(){function buildPredicate(e){"use strict";return function(t){if(!t)return!1;for(var n,r=e.length;r--;)if(n=e[r],t[n[0]]!==n[1])return!1;return!0}}function asFun(f){return f&&("string"==typeof f&&(f=eval("("+f+")")),"function"==typeof f)?f:null}return function(){"use strict";return{is:function(e){return"function"==typeof e},as:asFun,constant:function(e){return function(){return e}},compare:function(e,t){return e===t?0:e>t?1:-1},predicate:function(e){var t=[];return e&&Object.keys(e).forEach(function(n){var r=e[n];void 0!==r&&t.push([n,r])}),t.length?buildPredicate(t):null}}}()}),define("pentaho/util/text",[],function(){"use strict";var e={nonEmptyString:function(e){return null==e?null:String(e)||null},firstUpperCase:function(e){if(e){var t=e.charAt(0),n=t.toUpperCase();t!==n&&(e=n+e.substr(1))}return e},titleFromName:function(t){return t?e.firstUpperCase(t).replace(/([a-z\d])([A-Z])/g,"$1 $2"):t},toSnakeCase:function(e){return e&&(e=e.replace(/([a-z\d])([A-Z])/g,"$1-$2").replace(/[\/\\_\s\.@]+/g,"-").replace(/-+/g,"-"),"-"===e.charAt(0)&&(e="_"+e.substr(1))),e},andSentence:function(e,t){return e+(t?" "+this.withPeriod(t):"")},withPeriod:function(e){return e&&!/[.;!?]/.test(e[e.length-1])?e+".":e},escapeForHtmlElement:function(e){return null==e?"":e.toString().replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;")}};return e}),function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function t(e){return"function"==typeof e}function n(e){return"object"==typeof e&&null!==e}function r(e,t){F[B]=e,F[B+1]=t,2===(B+=2)&&T()}function i(){return function(){k(u)}}function o(){return function(){setTimeout(u,1)}}function u(){for(var e=0;e<B;e+=2){(0,F[e])(F[e+1]),F[e]=void 0,F[e+1]=void 0}B=0}function s(){}function a(){return new TypeError("You cannot resolve a promise with itself")}function l(){return new TypeError("A promises callback cannot return that same promise.")}function c(e){try{return e.then}catch(e){return X.error=e,X}}function f(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function h(e,t,n){z(function(e){var r=!1,i=f(n,t,function(n){r||(r=!0,t!==n?_(e,n):v(e,n))},function(t){r||(r=!0,m(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,m(e,i))},e)}function d(e,t){t._state===V?v(e,t._result):t._state===W?m(e,t._result):y(t,void 0,function(t){_(e,t)},function(t){m(e,t)})}function p(e,n){if(n.constructor===e.constructor)d(e,n);else{var r=c(n);r===X?m(e,X.error):void 0===r?v(e,n):t(r)?h(e,n,r):v(e,n)}}function _(t,n){t===n?m(t,a()):e(n)?p(t,n):v(t,n)}function g(e){e._onerror&&e._onerror(e._result),b(e)}function v(e,t){e._state===J&&(e._result=t,e._state=V,0!==e._subscribers.length&&z(b,e))}function m(e,t){e._state===J&&(e._state=W,e._result=t,z(g,e))}function y(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+V]=n,i[o+W]=r,0===o&&e._state&&z(b,e)}function b(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,i,o=e._result,u=0;u<t.length;u+=3)r=t[u],i=t[u+n],r?A(n,r,i,o):i(o);e._subscribers.length=0}}function w(){this.error=null}function O(e,t){try{return e(t)}catch(e){return G.error=e,G}}function A(e,n,r,i){var o,u,s,a,c=t(r);if(c){if(o=O(r,i),o===G?(a=!0,u=o.error,o=null):s=!0,n===o)return void m(n,l())}else o=i,s=!0;n._state!==J||(c&&s?_(n,o):a?m(n,u):e===V?v(n,o):e===W&&m(n,o))}function j(e,t){try{t(function(t){_(e,t)},function(t){m(e,t)})}catch(t){m(e,t)}}function S(e,t){var n=this;n._instanceConstructor=e,n.promise=new e(s),n._validateInput(t)?(n._input=t,n.length=t.length,n._remaining=t.length,n._init(),0===n.length?v(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&v(n.promise,n._result))):m(n.promise,n._validationError())}function E(e){return new Z(this,e).promise}function x(e){function t(e){_(i,e)}function n(e){m(i,e)}var r=this,i=new r(s);if(!N(e))return m(i,new TypeError("You must pass an array to race.")),i;for(var o=e.length,u=0;i._state===J&&u<o;u++)y(r.resolve(e[u]),void 0,t,n);return i}function I(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(s);return _(n,e),n}function M(e){var t=this,n=new t(s);return m(n,e),n}function P(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function C(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function R(e){this._id=ne++,this._state=void 0,this._result=void 0,this._subscribers=[],s!==e&&(t(e)||P(),this instanceof R||C(),j(this,e))}function q(){var e;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=re)}var L;L=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var k,T,N=L,B=0,z=r,U="undefined"!=typeof window?window:void 0,$=U||{},K=$.MutationObserver||$.WebKitMutationObserver,D="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),H="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,F=new Array(1e3);T=D?function(){var e=process.nextTick,t=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(t)&&"0"===t[1]&&"10"===t[2]&&(e=setImmediate),function(){e(u)}}():K?function(){var e=0,t=new K(u),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():H?function(){var e=new MessageChannel;return e.port1.onmessage=u,function(){e.port2.postMessage(0)}}():void 0===U&&"function"==typeof require?function(){try{var e=require,t=e("vertx");return k=t.runOnLoop||t.runOnContext,i()}catch(e){return o()}}():o();var J=void 0,V=1,W=2,X=new w,G=new w;S.prototype._validateInput=function(e){return N(e)},S.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},S.prototype._init=function(){this._result=new Array(this.length)};var Z=S;S.prototype._enumerate=function(){for(var e=this,t=e.length,n=e.promise,r=e._input,i=0;n._state===J&&i<t;i++)e._eachEntry(r[i],i)},S.prototype._eachEntry=function(e,t){var r=this,i=r._instanceConstructor;n(e)?e.constructor===i&&e._state!==J?(e._onerror=null,r._settledAt(e._state,t,e._result)):r._willSettleAt(i.resolve(e),t):(r._remaining--,r._result[t]=e)},S.prototype._settledAt=function(e,t,n){var r=this,i=r.promise;i._state===J&&(r._remaining--,e===W?m(i,n):r._result[t]=n),0===r._remaining&&v(i,r._result)},S.prototype._willSettleAt=function(e,t){var n=this;y(e,void 0,function(e){n._settledAt(V,t,e)},function(e){n._settledAt(W,t,e)})};var Y=E,Q=x,ee=I,te=M,ne=0,re=R;R.all=Y,R.race=Q,R.resolve=ee,R.reject=te,R.prototype={constructor:R,then:function(e,t){var n=this,r=n._state;if(r===V&&!e||r===W&&!t)return this;var i=new this.constructor(s),o=n._result;if(r){var u=arguments[r-1];z(function(){A(r,i,u,o)})}else y(n,i,e,t);return i},catch:function(e){return this.then(null,e)}};var ie=q,oe={Promise:re,polyfill:ie};"function"==typeof define&&define.amd?define("pentaho/shim/_es6-promise/es6-promise",[],function(){return oe}):"undefined"!=typeof module&&module.exports?module.exports=oe:void 0!==this&&(this.ES6Promise=oe),ie()}.call(this),define("pentaho/shim/es6-promise",["./_es6-promise/es6-promise"],function(e){return e.polyfill(),Promise}),define("pentaho/util/requireJS",["require","../shim/es6-promise"],function(e){var t=function(){return require.s.contexts[e.contextName||"_"]}(),n=Array.prototype.slice,r={define:function(e,n,i){if(!e||"string"!=typeof e)throw new Error("Argument 'id' is required.");return Array.isArray(n)||(i=n,n=null),n||"function"!=typeof i||(n=[]),t.defQueue.push([e,n,i]),t.defQueueMap[e]=!0,r},promise:function(e,r){if(null==e)throw new Error("Argument 'deps' is required.");var i=r||t.require;return Array.isArray(e)?new Promise(function(t,r){i(e,function(){t(n.call(arguments))},r)}):new Promise(function(t,n){i([e],t,n)})},config:function(e){return arguments.length>0?(t.configure(e),r):t.config}};return r}),define("pentaho/debug/Levels",["../util/object"],function(e){"use strict";var t={parse:function(t,r){if(null!=t&&""!==t){var i=Math.floor(+t);if(!isNaN(i))return Math.max(n.none,i);if(null!=(i=e.getOwn(n,String(t).toLowerCase())))return i}return null!=r?r:n.debug}},n={none:0,error:1,exception:1,warn:2,info:3,debug:4,log:4,trace:5,all:1/0};return n=Object.freeze(e.assignOwn(Object.create(t),n))}),define("pentaho/debug/impl/Manager",["../Levels","../../util/object"],function(e,t){"use strict";function n(){this.__level=e.error,this.__modules={}}function r(e){return"string"==typeof e?e:e.id}return n.prototype={configure:function(e){null!=e.level&&this.setLevel(e.level),t.eachOwn(e.modules,function(e,t){this.setLevel(e,t)},this)},getLevel:function(e){if(null==e)return this.__level;var n=t.getOwn(this.__modules,r(e));return null==n?this.__level:n},setLevel:function(t,n){var i=e.parse(t);null==n?this.__level=i:this.__modules[r(n)]=i},testLevel:function(t,n){return this.getLevel(n)>=e.parse(t)}},n}),define("pentaho/util/domWindow",[],function(){"use strict";return"undefined"!=typeof window?window:null}),define("pentaho/debug/manager",["../util/requireJS","./impl/Manager","./Levels","../util/domWindow"],function(e,t,n,r){"use strict";var i=e.config().config["pentaho/debug"]||{},o=function(){if(r){var e=function(e){var t;return/\bdebug=true\b/.test(t=e.location.href)?t:null};try{var t=e(r)||(r!==r.top?e(r.top):null);if(t){var i=/\bdebugLevel=(\w+)\b/.exec(t);return n.parse(i&&i[1])}}catch(e){}}}();null!=o&&(i.level=o);var u=new t;return u.configure(i),u}),define("pentaho/debug",["pentaho/debug/manager"],function(e){return e}),define("pentaho/lang/Base",["module","../util/object","../util/fun","../util/text","../debug","../debug/Levels"],function(e,t,n,r,i,o){"use strict";function u(e,t){return B.call(e,"__base_class_id__")?e.__base_class_id__:t?e.__base_class_id__=U++:null}function s(e,n,r,i){var o=function(){};o.prototype=n,n.extend=I,u(n,!0),t.setConst(n,"__base_bases__",Object.freeze({})),t.setConst(n,"__base_extend_exclude__",$),t.setConst(n,"__base_extend_order__",Object.freeze([])),t.setConst(n,"__base_ops__",Object.freeze([])),o.extend=a,o._extend=l,o._subclassed=h,o.mix=y,o.implement=A,o.implementStatic=S,o.to=v,o.toString=k;var s=o.extend({constructor:i},{ancestor:e}),c=s.prototype;return Object.defineProperty(c,"base",{configurable:!0,writable:!0,enumerable:!1,value:x}),t.setConst(c,"__base_root_proto__",c),T(s,r),s}function a(e,t,n,r){return arguments.length<4&&"string"!=typeof e&&(r=n,n=t,t=e,e=null),this._extend(e,t,n,r)}function l(e,t,n,r){var i=f.call(this,e,t,n,r);return this._subclassed(i,t,n,r),i}function c(e){if(e.indexOf("/")>0){var t=e.split("/"),n=t.length-1;t[n]=r.firstUpperCase(t[n]),e=t.join(".")}return e}function f(e,n,r,i){e?e=c(e):(e=this.name||this.displayName||null)&&(e+="$");var o=Object.create(this.prototype),s=d(o,n,e);t.setConst(o,"constructor",s),s.prototype=o,s.ancestor=this;var a=Object.create(o.__base_bases__);a[o.__base_class_id__]=1,u(o,!0),t.setConst(o,"__base_bases__",a),t.setConst(o,"__base_ops__",[{name:"mix",args:[n,r,i]}]);var l=n&&n.extend_exclude;l&&(l=t.assignOwn(t.assignOwn({},o.__base_extend_exclude__),l),t.setConst(o,"__base_extend_exclude__",Object.freeze(l)));var f=n&&n.extend_order;return f&&(f=(o.__base_extend_order__||[]).concat(f),t.setConst(o,"__base_extend_order__",Object.freeze(f))),j.call(s,this),s}function h(e,t,n,r){b.call(e,t,n,r)}function d(e,n,r){var i=e.__base_init__,o=p(n);return o?(o=C(o,i,e.__base_root_proto__,r,!0),t.setConst(e,"__base_init__",o)):o=_(i,r),r&&T(o,r),o}function p(e){var t=e&&e.constructor;return t&&t!==Object&&n.is(t)?t:null}function _(e,t){return t&&D?new Function("init","return function "+g(t)+"() {\n  return init.apply(this, arguments);\n};")(e):function(){return e.apply(this,arguments)}}function g(e){return e.replace(/[^\w0-9$_]/gi,"_")}function v(e){return e instanceof this?e:t.make(this,arguments)}function m(e){if(null==e)e=[];else{if(e instanceof this)return e;if(!(e instanceof Array))throw new Error("Cannot convert value to Base.Array.")}return t.applyClass(e,this,z.call(arguments,1))}function y(e,t,n){return this.prototype.__base_ops__.push({name:"mix",args:[e,t,n]}),b.call(this,e,t,n),this}function b(e,t,r){var i=this.prototype,o=n.is(e);if(o&&(r=t,t=e,e=t.prototype),e){if(e===i)return this;var s=u(e,!0);if(i.__base_bases__[s])return this}return o&&((this.mixins||(this.mixins=[])).push(t),e&&e.__base_ops__)?(w.call(this,t),this):(e&&i.extend(e,r),t&&E.call(this,t,r),this)}function w(e){for(var n=t.lca(this.prototype,e.prototype),r=[],i=e.prototype;i!==n;)r.push(i),i=Object.getPrototypeOf(i);for(var o=this.prototype,s=r.length;s--;){i=r[s];var a=u(i);o.__base_bases__[a]||(o.__base_bases__[a]=1,O.call(this,r[s].__base_ops__))}}function O(e){for(var t=-1,n=e.length;++t<n;)this[e[t].name].apply(this,e[t].args)}function A(){var e=this.prototype;e.__base_ops__.push({name:"implement",args:z.call(arguments)});for(var t=-1,r=arguments.length;++t<r;){var i=arguments[t];e.extend(n.is(i)?i.prototype:i)}return this}function j(e){for(var t in e)t in Object&&e[t]===Object[t]||B.call(K,t)||M.call(this,t,e,void 0,!0)}function S(){this.prototype.__base_ops__.push({name:"implementStatic",args:z.call(arguments)});for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];n&&E.call(this,n)}return this}function E(e,r){var i,o=r&&r.exclude;if(n.is(e)){var u=t.lca(this.prototype,e.prototype),s=u&&u.constructor;for(i in e)i in Object&&e[i]===Object[i]||B.call(K,i)||o&&B.call(o,i)||s&&P(Object.getOwnPropertyDescriptor(e,i),Object.getOwnPropertyDescriptor(s,i))||M.call(this,i,e)}else for(i in e)i in Object&&e[i]===Object[i]||B.call($,i)||B.call(K,i)||o&&B.call(o,i)||M.call(this,i,e)}function x(){}function I(e,n){if(e){var r=this,i=this.__base_root_proto__,o=this.__base_extend_exclude__,s=i&&t.lca(e,this);if(s)for(var a=e;a&&a!==s&&a!==i;){var l=u(a,!1);l&&(r.__base_bases__[l]=1),a=Object.getPrototypeOf(a)}var c,f=n&&n.exclude,h=Object.create(null),d=function(t){B.call(h,t)||B.call(o,t)||f&&B.call(f,t)||(h[t]=1,M.call(r,t,e,i,null,s))},p=this.__base_extend_order__;if(p)for(var _=-1,g=p.length;++_<g;)(c=p[_])in e&&d(c);for(c in e)d(c)}return this}function M(e,r,i,o,u){var s,a=t.getPropertyDescriptor(r,e,u);if(a)if(s=t.getPropertyDescriptor(this,e),a.get||a.set){if(s&&((a.get||s.get)&&(a.get=C(a.get,s.get,i)),(a.set||s.set)&&(a.set=C(a.set,s.set,i)),a.get===s.get&&a.set===s.set))return;Object.defineProperty(this,e,a)}else{if(s&&s.get&&!s.set)return;var l=a.value;n.is(l)?s&&(s.get||s.set)?this[e]=l:this[e]=C(l,s&&s.value,i,e):o||(this[e]=l)}}function P(e,t){return null==e&&null==t||!(!e||!t)&&(e.get===t.get&&e.set===t.set&&e.value===t.value)}function C(e,t,n,r,i){if(!e)return t;var o=e.valueOf();if(!t){if(o!==e)return e;t=x}return!o||t.valueOf&&t.valueOf()===o||!(i&&D||R(o))?e:(e=L(o,t,n,r),e.valueOf=function(t){return"object"===t?e:o},e.toString=k,e)}function R(e){return/\bthis(\s*)\.(\s*)base\b/.test(e)}function q(e,t,n){return n?function(){var r=n.base;n.base=t;try{return e.apply(this,arguments)}finally{n.base=r}}:function(){var n=this.base;this.base=t;try{return e.apply(this,arguments)}finally{this.base=n}}}function L(e,t,n,r){if(!r||!D)return q(e,t,n);return(n?new Function("_method_","_baseMethod_","_rootProto_","return function "+g(r)+"() {\n  var previous = _rootProto_.base; _rootProto_.base = _baseMethod_;\n  try {\n      return _method_.apply(this, arguments);\n  } finally { _rootProto_.base = previous; }\n};"):new Function("_method_","_baseMethod_","_rootProto_","return function "+g(r)+"() {\n  var previous = this.base; this.base = _baseMethod_;\n  try {\n     return _method_.apply(this, arguments);\n  } finally { this.base = previous; }\n};"))(e,t,n)}function k(){return N.call(this.valueOf())}function T(e,t){e.displayName=t;try{Object.defineProperty(e,"name",{value:t,configurable:!0})}catch(e){}}var N=Function.prototype.toString,B=Object.prototype.hasOwnProperty,z=Array.prototype.slice,U=1,$=Object.freeze({constructor:1,extend_order:1,extend_exclude:1,base:1,__base_init__:1,__base_root_proto__:1,__base_extend_order__:1,__base_extend_exclude__:1,__base_class_id__:1,__base_bases__:1,__base_ops__:1}),K=Object.freeze({ancestor:1,mixins:1,prototype:1,valueOf:1,Array:1,Object:1,base:1,name:1,displayName:1,extend_order:1,extend_exclude:1}),D=i.testLevel(o.debug,e);return function(){function e(e){this.extend(e)}function t(e){this.extend(e)}function n(e){this.message=e,this.stack=(new Error).stack}var r=s(Object,{},"Base.Object",e);return r.version="2.0",r.Object=r,r.Array=s(Array,[],"Base.Array",t),r.Array.to=m,r.Error=s(Error,Object.create(Error.prototype),"Base.Error",n),r}()}),define("pentaho/lang/List",["./Base"],function(e){var t=e.Array.prototype;return e.Array.extend("pentaho.lang.List",{constructor:function(e){this._addMany(this,e)},_added:null,_replaced:null,elemClass:null,_getElemName:function(){return this.elemClass.prototype.elemName},push:function(){return this._addMany(arguments)},addMany:function(e,t){return this._addMany(e,t)},add:function(e,t){return this.insert(e,this.length,t)},replace:function(e,t,n){var r=this[t],i=this._replacing(e,t,r,n);return void 0!==i&&r!==i&&(this[t]=i,this._replaced&&this._replaced(i,t,r,n)),i},insert:function(e,n,r){var i=this._adding(e,n,r);return void 0!==i&&(t.splice.call(this,n,0,i),this._added&&this._added(i,n,r)),i},_adding:function(e,t,n){return this._cast(e,t,n)},_replacing:function(e,t,n){return this._cast(e,t,n)},_cast:function(e,t,n){return this.elemClass?this.elemClass.to(e,n):e},_addMany:function(e,n){var r=e===this,i=e.length;if(!i)return this.length;for(var o=this._added,u=0,s=r?0:this.length;u<i;){var a=e[u],l=this._adding(a,s,n);if(void 0===l){if(r){this.splice(s,1),i--;continue}}else r?a!==l&&(this[s]=l):t.push.call(this,l),o&&o.call(this,l,s,n);s++,u++}return s},copyTo:function(e){t.push.apply(e,this)},toSpec:function(){return this.map(function(e){return e.toSpec?e.toSpec():e})}})}),define("pentaho/lang/SortedList",["./List","./Base","../util/object"],function(e,t,n){"use strict";var r=t.Array.prototype;return e.extend("pentaho.lang.SortedList",{constructor:function(e){null!=e&&(null!=e.orderingMode&&(this.__orderingMode=+e.orderingMode),"function"==typeof e.comparer&&(this.comparer=e.comparer)),this.base(e)},__comparer:function(e,t){if(null==e||null==t)return null!=e?1:null!=t?-1:0;var n=e.valueOf(),r=t.valueOf();return n===r?0:n>r?1:-1},__orderingMode:2,get orderingMode(){return this.__orderingMode},get comparer(){return this.__comparer},set comparer(e){var t=n.hasOwn(this,"__comparer");(t&&this.__comparer!==e||!t&&null!=e)&&(null==e?delete this.__comparer:this.__comparer=e,this.sort())},sort:function(e){if(null!=e&&e!==this.__comparer)throw new Error("Can't specify a different sorting function in a sorted list.");this.base(this.__comparer)},search:function(e){for(var t=0,n=this.length-1;t<=n;){var r=(t+n)/2|0,i=this.__comparer(this[r],e);if(i<0)t=r+1;else{if(!(i>0))return r;n=r-1}}return~t},copyWithin:function(){throw new Error("Can't copy within a sorted list.")},fill:function(){throw new Error("Can't fill a sorted list.")},reverse:function(){throw new Error("Can't reverse a sorted list.")},unshift:function(){throw new Error("Can't do a indexed insert in a sorted list.")},insert:function(){throw new Error("Can't do a indexed insert in a sorted list.")},replace:function(){throw new Error("Can't do a indexed replace in a sorted list.")},splice:function(){if(arguments.length>2)throw new Error("Can't do a indexed insert in a sorted list.");this.base(arguments)},__insertInOrder:function(e,t){var i=this._adding(e,null,t);if(void 0!==i){var o=this.search(i);if(o<0)o=~o;else switch(n.getOwn(t,"orderingMode",this.__orderingMode)){case 1:for(;o>0&&0===this.__comparer(this[o-1],i);)o--;break;case 2:for(var u=this.length-1;o<u&&0===this.__comparer(i,this[o+1]);)o++;o++}r.splice.call(this,o,0,i),this._added&&this._added(i,o,t)}return i},_addMany:function(e,t){var n=e===this,r=e.length;if(!r)return this.length;var i=0;if(n){for(;i<r;){var o=e[i],u=this._adding(o,i,t);void 0!==u?(o!==u&&(this[i]=u),this._added&&this._added(u,i,t),i++):(this.splice(i,1),r--)}this.sort()}else for(;i<r;)this.__insertInOrder(e[i],t),i++;return r},add:function(e,t){this.__insertInOrder(e,t)}},{OrderingMode:{Total:0,PartialInsertBefore:1,PartialInsertAfter:2}})}),define("pentaho/lang/ArgumentError",["./Base"],function(e){"use strict";return e.Error.extend("pentaho.lang.ArgumentError",{constructor:function(e,t){this.base(t),this.argument=e},name:"ArgumentError"})}),define("pentaho/lang/ArgumentRequiredError",["./ArgumentError","../util/text"],function(e,t){"use strict";return e.extend("pentaho.lang.ArgumentRequiredError",{constructor:function(e,n){this.base(e,t.andSentence("Argument "+e+" is required.",n))},name:"ArgumentRequiredError"})}),define("pentaho/lang/ArgumentInvalidError",["./ArgumentError","../util/text"],function(e,t){"use strict";return e.extend("pentaho.lang.ArgumentInvalidError",{constructor:function(e,n){this.base(e,t.andSentence("Argument "+e+" is invalid.",n))},name:"ArgumentInvalidError"})}),define("pentaho/_core/module/MetaService",["../../lang/SortedList","../../lang/ArgumentRequiredError","../../lang/ArgumentInvalidError","../../util/object","../../util/fun","../../util/text"],function(e,t,n,r,i,o){var u=1;return function(t){function s(){this.__moduleMap=Object.create(null)}function a(){return new e({comparer:d})}function l(e,t){f(t,function(t){var n=t.instances;n.length>0&&e.addMany(n)})}function c(e,t){f(t,function(n){n!==t&&e.add(n)})}function f(e,t){t(e);for(var n=e.subtypes,r=n.length;r--;)f(n[r],t)}function h(e,t,r){var i=e.get(t);if(null!==i&&"type"!==i.kind)throw new n(r,"Expected module with id or alias '"+t+"' to be a type module.");return i}function d(e,t){return i.compare(t.ranking,e.ranking)||i.compare(e.__index,t.__index)}return s.prototype={__get:function(e){return r.getOwn(this.__moduleMap,e,null)},configure:function(e){function i(e,t){if(!t)throw new n("moduleSpecMap","Module map contains an empty module identifier.");if(!e)throw new n("moduleSpecMap","Module with id '"+t+"' provides no specification.");var i=this.__get(t);if(null!==i)i.__configure(e);else{if(r.hasOwn(c,t))throw new n("moduleSpecMap","A module with the id or alias '"+t+"' is already being defined.");e=Object.create(e),e.id=t,e.index=u++,f.push(t),c[t]=e;var s=o.nonEmptyString(e.alias);if(null!==s&&s!==t){if(null!==this.__get(s)||r.hasOwn(c,s))throw new n("moduleSpecMap","Module with id '"+t+"' specifies an alias which is already taken: '"+s+"'.");c[s]=e}}}function s(e,t){var i=l.__get(e);if(null===i){var o=r.getOwn(c,e,null);if(null===o)throw new n("moduleSpecMap","A module with id '"+e+"' is not defined.");i=a(o)}if(t&&i.kind!==t)throw new n("moduleSpecMap","Expected module '"+i.id+"' to be "+("type"===t?"a ":"an ")+t);return i}function a(e){var n;return n="ancestor"in e||"base"in e?new t.TypeModuleMeta(e.id,e,s):new t.InstanceModuleMeta(e.id,e,s),l.__registerModule(n),e.annotations,n}if(null==e)return this;var l=this,c={},f=[];return r.eachOwn(e,i,this),f.forEach(function(e){s(e)}),this},__registerModule:function(e){this.__moduleMap[e.id]=e,null!==e.alias&&(this.__moduleMap[e.alias]=e)},get:function(e,i){var o=this.__get(e);if(null===o)if(r.getOwn(i,"createIfUndefined",!1))o=new t.InstanceModuleMeta(e,{},null),this.__registerModule(o);else if(r.getOwn(i,"assertDefined",!1))throw new n("idOrAlias","A module with id or alias '"+e+"' is not defined.");return o},getId:function(e){var t=this.get(e);return t&&t.id},getInstancesOf:function(e){var t=a(),n=h(this,e,"typeIdOrAlias");return null!==n&&l(t,n),t},getInstanceOf:function(e){var t=this.getInstancesOf(e);return t.length>0?t[0]:null},getSubtypesOf:function(e){var t=a(),n=h(this,e,"baseTypeIdOrAlias");return null!==n&&c(t,n),t},getSubtypeOf:function(e){var t=this.getSubtypesOf(e);return t.length>0?t[0]:null}},s}}),define("pentaho/util/logger",[],function(){"use strict";function e(e,t,n){if(t=t||"info","undefined"!=typeof console){if(console[t]||(t="log"),n)try{return void console[t]("%c"+e,n)}catch(e){}console[t](e)}}return{logLevels:["debug","log","info","warn","error"],logLevel:"log",debug:function(t){e(t,"debug")},log:function(t){e(t,"log")},info:function(t){e(t,"info")},warn:function(t){e(t,"warn")},error:function(t){e(t,"error")}}}),define("pentaho/util/arg",["../lang/ArgumentRequiredError"],function(e){"use strict";var t=Array.prototype.slice;return{optional:function(e,t,n){var r;return e&&null!=(r=e[t])?r:n},defined:function(e,t,n){var r;return e&&void 0!==(r=e[t])?r:n},required:function(t,n,r){var i;if(t&&null!=(i=t[n]))return i;throw new e((r?r+".":"")+n)},slice:function(n,r,i){if(!n)throw new e("args");switch(arguments.length){case 1:return t.call(n);case 2:return t.call(n,r)}return t.call(n,r,i)}}}),define("pentaho/lang/ArgumentInvalidTypeError",["./ArgumentError","../util/text"],function(e,t){"use strict";return e.extend("pentaho.lang.ArgumentInvalidTypeError",{constructor:function(e,n,r){var i="Expected type to be ";if(Array.isArray(n)||(n=[n]),n.length>1){var o=n.slice(),u=o.pop();i+="one of "+o.join(", ")+" or "+u}else i+=n[0];i+=r?", but got "+r+".":".",this.base(e,t.andSentence("Argument "+e+" is invalid.",i)),this.actualType=r||null,this.expectedTypes=n},name:"ArgumentInvalidTypeError"})}),define("pentaho/lang/ArgumentRangeError",["./ArgumentError"],function(e){"use strict";return e.extend("pentaho.lang.ArgumentRangeError",{constructor:function(e){this.base(e,"Argument "+e+" is out of range.")},name:"ArgumentRangeError"})}),define("pentaho/lang/OperationInvalidError",["./Base","../util/text"],function(e,t){"use strict";return e.Error.extend("pentaho.lang.OperationInvalidError",{constructor:function(e){this.base(t.andSentence("Operation invalid.",e))},name:"OperationInvalidError"})}),define("pentaho/lang/NotImplementedError",["./Base","../util/text"],function(e,t){"use strict";return e.Error.extend("pentaho.lang.NotImplementedError",{constructor:function(e){this.base(t.andSentence("Not Implemented.",e))},name:"NotImplementedError"})}),define("pentaho/util/error",["../lang/ArgumentRequiredError","../lang/ArgumentInvalidError","../lang/ArgumentInvalidTypeError","../lang/ArgumentRangeError","../lang/OperationInvalidError","../lang/NotImplementedError"],function(e,t,n,r,i,o){"use strict";return{argRequired:function(t,n){return new e(t,n)},argInvalid:function(e,n){return new t(e,n)},argInvalidType:function(e,t,r){return new n(e,t,r)},argRange:function(e){return new r(e)},operInvalid:function(e){return new i(e)},notImplemented:function(e){return new o(e)}}}),define("pentaho/util/promise",["./arg","./error","../shim/es6-promise"],function(e,t){"use strict";return{wrapCall:function(e,n){if(!e)throw t.argRequired("fun");return new Promise(function(t){t(e.call(n))})},finally:function(e,n,r){if(!e)throw t.argRequired("promise");if(!n)throw t.argRequired("fun");return e.then(function(e){return n.call(r),e},function(e){return n.call(r),Promise.reject(e)})},return:function(e,t){return t?e:Promise.resolve(e)},error:function(e,t){if(t)throw e;return Promise.reject(e)}}}),define("pentaho/util/spec",["./object","../lang/OperationInvalidError"],function(e,t){"use strict";function n(t,n){for(var i in n)e.hasOwn(n,i)&&r(t,i,n[i]);return t}function r(n,r,i){var o;a(i)&&((o=i.$op)?(i=i.value,("merge"===o&&!a(i)||"add"===o&&!Array.isArray(i))&&(o="replace")):o="merge");var u=e.getOwn(l,o||"replace");if(!u)throw new t("Merge operation '"+o+"' is not defined.");u(n,r,i)}function i(e,t,r){var i=e[t];a(i)?n(i,r):o(e,t,r)}function o(e,t,n){e[t]=s(n)}function u(e,t,n){var r;if(Array.isArray(n)&&Array.isArray(r=e[t]))for(var i=-1,u=n.length;++i<u;)r.push(s(n[i]));else o(e,t,n)}function s(t){if(t&&"object"==typeof t)if(t instanceof Array)t=t.map(s);else if(t.constructor===Object){var n={};e.eachOwn(t,function(e,t){this[t]=s(e)},n),t=n}return t}function a(e){return!!e&&"object"==typeof e&&e.constructor===Object}var l={replace:o,merge:i,add:u};return{merge:n}}),define("pentaho/module/util",["../util/requireJS","../util/object","../lang/OperationInvalidError","../lang/ArgumentRequiredError"],function(e,t,n,r){"use strict";function i(e){var n;if(null==e)n=u["*"]||null;else if(void 0===(n=t.getOwn(u,e))){var r="";for(var i in u)"*"!==i&&0===e.indexOf(i)&&i.length>r.length&&(r=i);0===r.length&&(r="*"),n=u[r]||null}return n}function o(e,n){var r=n;if(!t.hasOwn(e,n)){var i="";for(var o in e)0===n.indexOf(o)&&o.length>i.length&&(i=o);if(0===i.length)return n;r=i}var u=n.substring(r.length);return u.length>0&&0!==u.indexOf("/")?n:e[r]+u}var u=e.config().map||{},s=/^(?:((?:@[^\/@]+\/)?[^\/@]+)@([^\/@]+)\/)?(.*)$/,a={getBaseIdOf:function(e){
return e&&e.replace(/.[^\/]+$/,"")},getLeafIdOf:function(e){var t=e&&/[^\/]+$/.exec(e);return null!==t?t[0]:null},getId:function(e){return e.undef?null:e("module").id},absolutizeIdRelativeToSibling:function(e,t){return this.absolutizeId(e,this.getBaseIdOf(t))},absolutizeId:function(e,t){if(e&&/^\./.test(e)&&!/\.js$/.test(e)){for(var r=t?t.split("/"):[],i=e.split("/"),o=!1;i.length;){var u=i[0];if("."===u)i.shift(),o=!0;else{if(".."!==u)break;if(!r.pop())throw new n("Invalid path: '"+e+"'.");i.shift(),o=!0}}if(o)return t=r.join("/"),e=i.join("/"),t&&e?t+"/"+e:t||e}return e},resolveModuleId:function(e,t){if(-1!==e.indexOf("!")){var n=e.split("!",2);return a.resolveModuleId(n[0],t)+"!"+a.resolveModuleId(n[1],t)}var r=a.absolutizeIdRelativeToSibling(e,t),u=i(t);return null!==u?o(u,r):r},parseId:function(e){if(null==e)throw new r("id");var t=s.exec(e);return{package:t[1]?{name:t[1],version:t[2]}:null,name:t[3]}}};return a}),define("pentaho/_core/module/Meta",["module","../../lang/Base","../../debug","../../debug/Levels","../../util/object","../../util/requireJS","../../util/logger","../../util/promise","../../util/text","../../util/fun","../../util/spec","../../util/arg","../../module/util","../../lang/ArgumentRequiredError","../../lang/OperationInvalidError"],function(e,t,n,r,i,o,u,s,a,l,c,f,h,d,p){"use strict";var _=1,g=2,v=-1,m=Object.freeze({value:null,error:null});return function(s){function c(e,t){return new p("The annotation '"+t+"' is not available in module '"+e+"'.")}function y(e){if(null==e)throw new d("Annotation");if("string"==typeof e)return e;var t=e.id;if(null==t)throw new d("Annotation.id");return t}return t.extend("pentaho._core.module.Meta",{constructor:function(e,t,n){this.id=e,this.__index=t.index||0,this.alias=a.nonEmptyString(t.alias),this.alias===e&&(this.alias=null),this.ranking=0,this.__state=0,this.__result=void 0,this.__promisesControl=null,this.__config=null,this.__configSpec=t.config||null,this.__annotationsStore=null,this.__configure(t);var r=t.value;this.isVirtual=!!t.isVirtual||void 0!==r,this.isVirtual&&this.__defineRequireJSValue(r)},__configure:function(e){"ranking"in e&&(this.ranking=+e.ranking||0);var t=e.annotations;null!=t&&null!==s.configService&&Object.keys(t).forEach(function(e){s.configService.addRule({priority:-1/0,select:{module:this.id,annotation:e},apply:t[e]})},this)},resolveId:function(e){return h.resolveModuleId(e,this.id)},import:function(e){return e=this.resolveId(e),o.promise(e).then(function(e){return{default:e}})},isSubtypeOf:function(e){return!1},isInstanceOf:function(e){return!1},get isPrepared(){return this.__state>=_},get isLoaded(){return this.__state>=g},get isRejected(){return this.__state===v},prepareAsync:function(){if(this.isPrepared)return Promise.resolve();if(this.isRejected)return Promise.reject(this.__result);var e=this.__getPromisesControl();return null===e.prepare&&(e.prepare=this._prepareCoreAsync()),e.prepare},_prepareCoreAsync:function(){var e=[];if(null!==s.configService){e.push(s.configService.selectAsync(this.id).then(this.__setConfig.bind(this)));var t=this.getAnnotationsIds();null!==t&&t.forEach(function(t){e.push(this.getAnnotationAsync(t))},this)}return Promise.all(e).then(this.__onPrepareResolved.bind(this),this.__onLoadRejected.bind(this))},__onPrepareResolved:function(){this.__state=_,null!==this.__promisesControl&&(this.__promisesControl.prepare=null)},__defineRequireJSValue:function(e){o.define(this.id,["pentaho/module!_"],l.is(e)?e:l.constant(e))},get value(){if(this.isRejected)throw this.__result;return this.__result},get error(){return this.isRejected?this.__result:null},loadAsync:function(){if(this.isLoaded)return Promise.resolve(this.__result);if(this.isRejected)return Promise.reject(this.__result);var e=this.__getPromisesControl();return null===e.value&&(e.value=Promise.all([o.promise(this.id),this.prepareAsync()]).then(function(e){return this.__onLoadResolved(e[0])}.bind(this),this.__onLoadRejected.bind(this))),e.value},__getPromisesControl:function(){return this.__promisesControl||(this.__promisesControl={prepare:null,value:null})},__onLoadResolved:function(t){return this.__state=g,this.__result=t,this.__promisesControl=null,n.testLevel(r.info,e)&&u.info("Loaded module '"+this.id+"'."),t},__onLoadRejected:function(t){return this.__state!==v&&("string"==typeof t&&(t=new Error(t)),this.__state=v,this.__result=t,this.__promisesControl=null,n.testLevel(r.error,e)&&u.error("Failed loading module '"+this.id+"'. Error: "+t.message)),Promise.reject(this.__result)},get config(){return this.__config},__setConfig:function(e){this.__config=e},hasAnnotation:function(e,t){var n=y(e);return this._hasAnnotationCore(n,t)},_hasAnnotationCore:function(e,t){return null!==this._getAnnotationHolder(e)||!this.isPrepared&&null!==s.configService&&s.configService.hasAnnotation(this.id,e)},_getAnnotationHolder:function(e){return i.getOwn(this.__annotationsStore,e,null)},getAnnotationsIds:function(e){return this.isPrepared?null===this.__annotationsStore?null:Object.keys(this.__annotationsStore):null!==s.configService?s.configService.getAnnotationsIds(this.id):null},getAnnotation:function(e,t){var n=y(e),r=this._getAnnotationResult(n,t);if(null==r||r===m){if(f.optional(t,"assertResult"))throw c(this.id,n);return null}if(null!==r.error)throw r.error;return r.value},getAnnotationAsync:function(e,t){if(null==e)return Promise.reject(new d("Annotation"));var n;if("string"==typeof e)n=e,e=null;else if(null==(n=e.id))return Promise.reject(new d("Annotation.id"));var r=null===e?s.moduleMetaService.get(n,{createIfUndefined:!0}).loadAsync():Promise.resolve(e),i=this;return r.then(function(e){return i._getAnnotationCoreAsync(e,n,t)}).then(function(e){return null===e&&f.optional(t,"assertResult")?Promise.reject(c(i.id,n)):e})},_getAnnotationCoreAsync:function(e,t,n){var r=this._getAnnotationHolder(t);if(null!==r)return r.promise;if(!this.isPrepared&&null!==s.configService&&s.configService.hasAnnotation(this.id,t)){var i=s.configService.selectAsync(this.id,t).then(function(t){return e.createAsync(this,t)}.bind(this)).then(function(e){return r.result={value:e,error:null},e},function(e){return r.result={value:null,error:e},Promise.reject(e)});return(this.__annotationsStore||(this.__annotationsStore=Object.create(null)))[t]=r={result:null,promise:i},i}return null},_getAnnotationResult:function(e,t){var n=this._getAnnotationHolder(e);return null!==n?n.result||m:!this.isPrepared&&null!==s.configService&&s.configService.hasAnnotation(this.id,e)?m:null}})}}),define("pentaho/_core/module/InstanceMeta",["../../lang/ArgumentRequiredError"],function(e){"use strict";return function(t){return t.ModuleMeta.extend("pentaho._core.module.InstanceMeta",{get kind(){return"instance"},constructor:function(e,t,n){this.base(e,t,n);var r=t.type||null;this.type=r&&n(r,"type"),r&&this.type.__addInstance(this)},isInstanceOf:function(t){if(!t)throw new e("typeIdOrAlias");return null!==this.type&&this.type.isSubtypeOf(t)},_prepareCoreAsync:function(){return null!==this.type?this.type.prepareAsync().then(this.base.bind(this)):this.base()}})}}),define("pentaho/_core/module/TypeMeta",["../../lang/ArgumentRequiredError","../../lang/ArgumentInvalidError","../../util/object","../../util/arg"],function(e,t,n,r){"use strict";function i(e,t){for(var r=Object.create(null),i=e.length;i--;)r[e[i]]=!0;var o=null,u=t.length;for(i=-1;++i<u;){var s=t[i];n.hasOwn(r,s)||(null===o&&(o=e.slice()),o.push(s))}return o||e}var o={assertDefined:!0};return function(u){var s=u.ModuleMeta.extend("pentaho._core.module.TypeMeta",{constructor:function(e,t,n){this.base(e,t,n);var r=t.ancestor||t.base||null,i=null!==r?n(r,"type"):null;this.ancestor=i,null!==i&&i.__addSubtype(this)},get kind(){return"type"},__subtypes:Object.freeze([]),get subtypes(){return this.__subtypes},__addSubtype:function(e){var t=n.getOwn(this,"__subtypes",null);null===t&&(this.__subtypes=t=[]),t.push(e)},__instances:Object.freeze([]),get instances(){return this.__instances},__addInstance:function(e){var t=n.getOwn(this,"__instances",null);null===t&&(this.__instances=t=[]),t.push(e)},isSubtypeOf:function(n){if(!n)throw new e("baseIdOrAlias");var r="string"==typeof n?u.moduleMetaService.get(n,o):n;if(!(r instanceof s))throw new t("baseIdOrAlias","Must be or identify a type module.");var i=this;do{if(r===i)return!0;i=i.ancestor}while(null!==i);return!1},_prepareCoreAsync:function(){return null!==this.ancestor?this.ancestor.prepareAsync().then(this.base.bind(this)):this.base()},_hasAnnotationCore:function(e,t){var n=this.base(e,t);return!n&&null!==this.ancestor&&r.optional(t,"inherit")&&(n=this.ancestor._hasAnnotationCore(e,t)),n},getAnnotationsIds:function(e){var t=this.base(e);if(null!==this.ancestor&&r.optional(e,"inherit")){var n=this.ancestor.getAnnotationsIds(e);null!==n&&(t=null===t?n:i(t,n))}return t},_getAnnotationResult:function(e,t){var n=this.base(e,t);return null===n&&null!==this.ancestor&&r.optional(t,"inherit")&&(n=this.ancestor._getAnnotationResult(e,t)),n},_getAnnotationCoreAsync:function(e,t,n){var i=this.base(e,t,n);return null===i&&null!==this.ancestor&&r.optional(n,"inherit")&&(i=this.ancestor._getAnnotationCoreAsync(e,t,n)),i}});return s}}),define("pentaho/_core/module/Service",[],function(){function e(e){this.__metaService=e}function t(e){if(e.length>0){var t=e.map(function(e){return e.loadAsync().catch(function(){return r})});return Promise.all(t).then(function(e){return e.filter(n)})}return Promise.resolve([])}function n(e){return e!==r}var r={};return e.prototype={getInstancesOfAsync:function(e){try{return t(this.__metaService.getInstancesOf(e))}catch(e){return Promise.reject(e)}},getInstanceOfAsync:function(e){try{var t=this.__metaService.getInstanceOf(e);return null!==t?t.loadAsync():Promise.resolve(void 0)}catch(e){return Promise.reject(e)}},getSubtypesOfAsync:function(e){try{return t(this.__metaService.getSubtypesOf(e))}catch(e){return Promise.reject(e)}},getSubtypeOfAsync:function(e){try{var t=this.__metaService.getSubtypeOf(e);return null!==t?t.loadAsync():Promise.resolve(void 0)}catch(e){return Promise.reject(e)}}},e}),define("pentaho/module/Annotation",["module","pentaho/lang/Base","pentaho/lang/ArgumentRequiredError","pentaho/shim/es6-promise"],function(e,t,n){var r=/Annotation$/;return t.extend(e.id,{constructor:function(e){if(null==e)throw new n("forModule");this.__forModule=e},get forModule(){return this.__forModule}},{get id(){return e.id},toFullId:function(e){return r.test(e)?e:e+"Annotation"},createAsync:function(e,t){return Promise.resolve(new this(e,t))}})}),define("pentaho/_core/config/Service",["module","../../lang/Base","../../lang/SortedList","../../lang/ArgumentRequiredError","../../util/spec","../../util/object","../../util/requireJS","../../util/fun","../../module/util","../../module/Annotation"],function(e,t,n,r,i,o,u,s,a,l){"use strict";function c(e,t){return e+(t?"|"+t:"")}function f(e){return e&&e.reduce(function(e,t){return i.merge(e,t)},{})}function h(e){return e.forEach(function(e,t){e.ordinal=t}),e.sort(_),e.reduce(function(e,t){return i.merge(e,t.config)},{})}function d(e,t){return function(n){var r=t.map(function(e){return n[e]});return e.apply(null,r)}}function p(e,t){var n=e.priority||0,r=t.priority||0;if(n!==r)return n>r?1:-1;for(var i=e.select||{},o=t.select||{},u=0,s=g.length;u!==s;++u){var a=g[u],l=null!=i[a];if(l!==(null!=o[a]))return l?1:-1}return e._ordinal>t._ordinal?1:-1}function _(e,t){var n=e.priority||0,r=t.priority||0;return n!==r?n>r?1:-1:e.ordinal>t.ordinal?1:-1}var g=["user","theme","locale","application"],v=g.length;return function(i){function _(e){var t=i.moduleMetaService.get(e);return null!==t?t.loadAsync():u.promise(e)}function m(e,t){var n=null;return e&&("."!==e[0]&&(n=i.moduleMetaService.getId(e)),null===n&&(n=a.resolveModuleId(e,t))),n}function y(e,t){var n=null;return e&&("."!==e[0]&&(n=i.moduleMetaService.getId(e)),null===n&&(n=a.resolveModuleId(l.toFullId(e),t))),n}var b=0;return t.extend(e.id,{constructor:function(e,t){this.__environment=e||{},this.__ruleStore=Object.create(null),this.__moduleAnnots=Object.create(null),this.__selectExternalAsync=t||null},add:function(e){if(e&&e.rules){var t=e.contextId||null;e.rules.forEach(function(e){this.addRule(e,t)},this)}},addRule:function(e,t){e._ordinal=b++;var n=e.select||{},i=n.module;if(!i)throw new r("rule.select.module");var o=n.application;if(o&&(Array.isArray(o)?n.application=o.map(function(e){return m(e,t)}):n.application=m(o,t)),this.__applySelector(n)){var u=n.annotation||null;null!==u&&(u=y(u,t)),Array.isArray(i)||(i=[i]);var s=e.deps;s&&s.forEach(function(e,n){s[n]=m(e,t)}),i.forEach(function(n){if(!n)throw new r("rule.select.module");n=m(n,t),this.__addRule(n,u,e)},this)}},__addRule:function(e,t,r){var i=c(e,t),o=this.__ruleStore[i];o||(this.__ruleStore[i]=o=new n({comparer:p})),o.push(r),t&&((this.__moduleAnnots[e]||(this.__moduleAnnots[e]=Object.create(null)))[t]=!0)},__applySelector:function(e){for(var t=v,n=this.__environment;t--;){var r=g[t],i=e[r];if(null!=i){var o=n[r];if(void 0!==o&&(Array.isArray(i)?-1===i.indexOf(o):i!==o))return!1}}return!0},selectAsync:function(e,t){var n=this.__selectInternalAsync(e,t),r=this.__selectExternalAsync;if(t||null===r)return n.then(f);var i=Promise.resolve(r(e));return Promise.all([n,i]).then(function(e){var t=e[0],n=e[1];if(null==n)return f(t);if(null===t)return h(n);var r=t.map(function(e){return{priority:0,config:e}});return n.push.apply(n,r),h(n)})},getAnnotationsIds:function(e){var t=this.__moduleAnnots[e];return t?Object.keys(t):null},hasAnnotation:function(e,t){var n=this.__moduleAnnots[e];return n?!!n[t]:null},__selectInternalAsync:function(e,t){var n=c(e,t),r=o.getOwn(this.__ruleStore,n,null);if(null===r)return Promise.resolve(null);var i=null,u=null,a=function(e){var t=o.getOwn(u,e,null);return null===t&&(t=i.length,u[e]=t,i.push(_(e))),t},l=function(e){var t=s.is(e.apply),n=t?[]:null;return e.deps&&(null===i&&(i=[],u=Object.create(null)),e.deps.forEach(function(e){var r=a(e);t&&n.push(r)})),t?d(e.apply,n):s.constant(e.apply)},f=r.map(l);return Promise.all(i||[]).then(function(e){return f.map(function(t){return t(e)})})}})}}),define("pentaho/config/ExternalAnnotation",["module","../module/Annotation"],function(e,t){return t.extend(e.id,{constructor:function(e,t){this.base(e),this._config=t},get config(){return this._config}},{get id(){return e.id},get priority(){return-1}})}),define("pentaho/_core/Core",["require","module","./module/MetaService","./module/Meta","./module/InstanceMeta","./module/TypeMeta","./module/Service","./config/Service","../module/util","../util/fun","../config/ExternalAnnotation","../util/requireJS"],function(e,t,n,r,i,o,u,s,a,l,c,f){"use strict";function h(e){this.environment=e,this.configService=null}var d=a.resolveModuleId("pentaho/config/spec/IRuleSet",t.id),p=a.resolveModuleId("pentaho/modules",t.id),_=c.id;return h.createAsync=function(e){function t(e){return e.loadAsync().then(function(t){return t&&!t.contextId&&(t.contextId=e.id),t},function(){return null})}function a(t){b.ConfigurationService=s(b);var n=b.configService=new b.ConfigurationService(e,c);return t.forEach(function(e){null!==e&&n.add(e)}),n.selectAsync(p).then(function(e){return null!==e&&b.moduleMetaService.configure(e),b.externalConfigAnnotationModule=b.moduleMetaService.get(_),b})}function c(e){if(e===p)return g();var t=null,n=b.moduleMetaService.get(e);if(null!==n){var r=n.__configSpec;null!==r&&(t=[{priority:-1/0,config:r}]);var i=v(n);if(null!==i)return null!==t&&(i=i.then(function(e){return t.push.apply(t,e),t})),i}return Promise.resolve(t)}function g(){var e=null,t=f.config().config[p]||null;if(null!==t){var n={};Object.keys(t).forEach(function(e){var r=t[e];r&&r.type!==d&&(n[e]=r)}),e=[{priority:-1/0,config:n}]}return Promise.resolve(e)}function v(e){var t=e.getAnnotationsIds();if(null!==t){var n=t.filter(y);if(n.length>0)return Promise.all(n.map(function(t){return e.getAnnotationAsync(t).then(m)}))}return null}function m(e){return{priority:e.constructor.priority,config:e.config}}function y(e){if(null===b.externalConfigAnnotationModule)return!1;var t=b.moduleMetaService.get(e);return null!==t&&t.isSubtypeOf(b.externalConfigAnnotationModule)}var b=new h(e);b.ModuleMeta=r(b),b.TypeModuleMeta=o(b),b.InstanceModuleMeta=i(b);var w=n(b);return b.moduleMetaService=new w,b.moduleMetaService.configure(function(){var e={},t=f.config().config[p]||null;return null!==t&&Object.keys(t).forEach(function(n){var r=t[n];!r||n!==d&&r.type!==d||(e[n]=r)}),e}()),b.moduleService=new u(b.moduleMetaService),b.externalConfigAnnotationModule=null,function(){var e=b.moduleMetaService.getInstancesOf(d);return 0===e.length?Promise.resolve([]):(e=e.slice().sort(function(e,t){return l.compare(e.id,t.id)}),Promise.all(e.map(t)))}().then(a)},h}),define("pentaho/util/url",["./has"],function(e){"use strict";function t(t){if(!t)return null;if(e("URL"))return new URL(t,document.location);var i=n(t)||n(t=r(t))||[t,"",null,"",null,t],o=i[1]||"",u=i[2]?i[2].slice(0,-1).split(":"):"",s=i[3]||"",a=i[4]?i[4].substring(1):"",l=i[5]||"";return{href:t,protocol:o,username:u.length>0?u[0]:"",password:u.length>1?u[1]:"",hostname:s,host:s+":"+a,port:a,origin:o+"//"+s+":"+a,pathname:l,toString:function(){return t}}}function n(e){return/^\s*([^:\/?#]+:)\/\/([^@]*@)?([^:\/?#]*)(:\d*)?(\/[^?#]*)+/.exec(e)}function r(e){var t=document.createElement("a");return t.href=e,t.href}return{create:t,parse:n}}),define("pentaho/environment/impl/Environment",["pentaho/util/url"],function(e){"use strict";function t(t,r){t||(t={}),this.application=n(t,"application",r),this.theme=n(t,"theme",r);var i=n(t,"locale",r);this.locale=i&&i.toLowerCase();var o=n(t,"user"),u=n(r,"user");this.user=Object.freeze({id:n(o,"id",u),home:n(o,"home",u)}),o=n(t,"server"),u=n(r,"server"),this.server=Object.freeze({root:e.create(n(o,"root",u)),packages:e.create(n(o,"packages",u)),services:e.create(n(o,"services",u))}),this.reservedChars=n(t,"reservedChars",r),Object.freeze(this)}function n(e,t,n){return e&&e[t]||n&&n[t]||null}var r=t.prototype={createChild:function(e){return new t(e,this.toSpec())},toSpec:function(){return{application:this.application,theme:this.theme,locale:this.locale,user:{id:this.user.id,home:this.user.home},server:{root:this.server.root&&this.server.root.href,packages:this.server.packages&&this.server.packages.href,services:this.server.services&&this.server.services.href},reservedChars:this.reservedChars}}};return r.toJSON=r.toSpec,t}),define("pentaho/environment/main",["pentaho/util/requireJS","./impl/Environment"],function(e,t){"use strict";return new t(e.config().config["pentaho/environment"]||null)}),define("pentaho/environment",["pentaho/environment/main"],function(e){return e}),define("pentaho/_core/main",["./Core","pentaho/environment"],function(e,t){var n=null;return{load:function(r,i,o,u){u.isBuild?o({moduleMetaService:{},moduleService:{}}):(null===n&&(n=e.createAsync(t)),n.then(o,o.error))}}}),define("pentaho/config/service",["../_core/main!"],function(e){"use strict";return e.configService}),define("pentaho/module/service",["../_core/main!"],function(e){"use strict";return e.moduleService}),define("pentaho/module/metaService",["../_core/main!"],function(e){"use strict";return e.moduleMetaService}),define("pentaho/module/metaOf",["./metaService","./util","../shim/es6-promise"],function(e,t){"use strict";var n=/^\$_\$_/,r=0,i={createIfUndefined:!0};return{load:function(r,o,u,s){if(s.isBuild)u();else{("_"===r||n.test(r))&&(r=null);var a=t.getId(o),l=r?t.absolutizeIdRelativeToSibling(r,a):a,c=e.get(l,i);c.prepareAsync().then(function(){u(c)},u.error)}},normalize:function(e,t){return e&&"_"!==e?t(e):"$_$_"+ ++r}}}),define("pentaho/module",["pentaho/module/metaOf"],function(e){return e}),define("pentaho/module/impl/ServicePlugin",["../service","../util","pentaho/shim/es6-promise"],function(e,t){"use strict";function n(e){this._callModuleService=e}return n.prototype.load=function(n,r,i,o){if(o.isBuild)i();else{var u=t.getId(r),s=t.absolutizeIdRelativeToSibling(n,u);this._callModuleService(e,s).then(i,i.error)}},n}),define("pentaho/module/subtypeOf",["./impl/ServicePlugin"],function(e){"use strict";return new e(function(e,t){return e.getSubtypeOfAsync(t)})}),define("pentaho/module/subtypesOf",["./impl/ServicePlugin"],function(e){"use strict";return new e(function(e,t){return e.getSubtypesOfAsync(t)})}),define("pentaho/module/instanceOf",["./impl/ServicePlugin"],function(e){"use strict";return new e(function(e,t){return e.getInstanceOfAsync(t)})}),define("pentaho/module/instancesOf",["./impl/ServicePlugin"],function(e){"use strict";return new e(function(e,t){return e.getInstancesOfAsync(t)})}),define("pentaho/i18n/MessageBundle",["../util/object","../lang/ArgumentRequiredError"],function(e,t){"use strict";function n(e){this.source=e&&"object"==typeof e?e:{},this.__structured=null}function r(t){var n={};return e.eachOwn(t,i,n),n}function i(t,n){for(var r=n.split("."),i=this,o=0,u=r.length;o!==u;++o){var s=r[o];o<u-1?(e.hasOwn(i,s)||(i[s]={}),i=i[s]):i[s]=t}}return n.prototype.has=function(t){return null!=e.getOwn(this.source,t)},n.prototype.get=function(t,n,r){2===arguments.length&&"string"==typeof n&&(r=n,n=null);var i=e.getOwn(this.source,t);return null==i?void 0===r?t:r:this.format(i,n)},Object.defineProperty(n.prototype,"structured",{get:function(){return this.__structured||(this.__structured=r(this.source)),this.__structured}}),n.format=function(n,r){if(null==n)throw new t("text");var i;return i=null==r?function(e){return null}:"function"==typeof r?r:function(t){return e.getOwn(r,t)},String(n).replace(/(^|[^{])\{([^{}]+)\}/g,function(e,t,n){var r=i(n);return t+(null==r?"[?]":r.toString())})},n.prototype.format=n.format,n}),define("pentaho/i18n/LoadConfigAnnotation",["require","module","pentaho/config/ExternalAnnotation","pentaho/module/util","pentaho/i18n","pentaho/shim/es6-promise"],function(e,t,n,r,i){return n.extend(t.id,{},{get id(){return t.id},get priority(){return-10},createAsync:function(t,n){return new Promise(function(n,o){var u=r.getLeafIdOf(t.id),s=t.resolveId("./i18n/"+u),a={},l=function(e){n(e.structured)};l.error=o,i.load(s,e,l,a)})}})}),define("pentaho/theme/main",["require","module","pentaho/config/service","pentaho/module/util","pentaho/shim/es6-promise"],function(e,t,n,r){"use strict";function i(e){var t=[];return null!==e&&(e.main&&t.push(e.main),e.extensions&&e.extensions.forEach(function(e){t.push(e)})),t}function o(t){var n=i(t);return 0===n.length?Promise.resolve():new Promise(function(t,r){e(n,t,r)})}var u=/^\$_\$_/,s=0;return{load:function(e,t,i,s){if(s.isBuild)i();else{var a=u.test(e)?r.getId(t):e;n.selectAsync("pentaho/theme!"+a).then(o).then(function(){i()},i.error)}},normalize:function(e,t){return e&&"_"!==e?t(e):"$_$_"+ ++s}}}),define("pentaho/theme",["pentaho/theme/main"],function(e){return e}),define("pentaho/theme/ThemeAnnotation",["module","pentaho/module/Annotation","pentaho/module/metaService","pentaho/lang/ArgumentRequiredError"],function(e,t,n,r){var i=Object.freeze({createIfUndefined:!0});return t.extend(e.id,{constructor:function(e,t){this.base(e);var o=t&&t.main;if(!o)throw new r("annotSpec.main");this._main=n.get(e.resolveId(o),i);var u=t.extensions;this._extensions=null!=u?u.map(function(t){return n.get(e.resolveId(t),i)}):null},get main(){return this._main},get extensions(){return this._extensions}},{get id(){return e.id}})}),define("pentaho/theme/impl/Service",["module","pentaho/lang/Base","../ThemeAnnotation","pentaho/module/metaService","pentaho/module/util","pentaho/util/text","pentaho/lang/ArgumentRequiredError","pentaho/shim/es6-promise"],function(e,t,n,r,i,o,u){function s(e){return"string"==typeof e?e:e.id}function a(e){var t="type"===e.kind?e.ancestor:null;return null!==t?a(t).then(l.bind(null,e)):l(e)}function l(e){return e.getAnnotationAsync(n).then(c)}function c(e){return null===e?Promise.resolve():e.main.loadAsync().then(function(){if(null!==e.extensions)return Promise.all(e.extensions.map(function(e){return e.loadAsync()}))})}function f(e){var t=i.parseId(e);return d((t.package?t.package.name+"/":"")+t.name)}function h(e){return d(e)}function d(e){return o.toSnakeCase(e)}return t.extend(e.id,{loadModuleThemeAsync:function(e){if(!e)throw new u("moduleOrIdOrArrayOf");Array.isArray(e)||(e=[e]);var t=e.map(function(e){return"string"==typeof e?r.get(e):e}).filter(function(e){return null!==e});return 0===t.length?Promise.resolve():Promise.all(t.map(a))},classifyDomAsModule:function(e,t){var n=s(t),r=e.classList;r&&(r.add(f(n)),r.add(h(n)))},getModuleCssClass:function(e){return f(s(e))},getModuleUniqueCssClass:function(e){return h(s(e))},getModuleCssClasses:function(e){var t=s(e),n=[f(t)],r=h(t);return r!==n[0]&&n.push(r),n.join(" ")}})}),define("pentaho/theme/service",["./impl/Service"],function(e){return new e}),define("pentaho/theme/LoadThemeAnnotation",["module","pentaho/module/Annotation","./service"],function(e,t,n){var r=t.extend(e.id,{},{get id(){return e.id},createAsync:function(e,t){return n.loadModuleThemeAsync(e.id).then(function(){return new r(e)})}});return r}),define("pentaho/csrf/service",["pentaho/util/url","pentaho/environment"],function(e,t){"use strict";var n={getToken:function(r){if(!r)throw new Error("Argument 'url' is required.");var i=t.server.root;if(null===i)return null;if(i=i.href,r=e.create(r).href,0!==r.indexOf(i))return null;var o=i+"api/system/csrf?url="+encodeURIComponent(r),u=n.__createXhr();u.open("GET",o,!1),u.withCredentials=!0;try{u.send()}catch(e){return null}if(204!==u.status&&200!==u.status)return null;var s=u.getResponseHeader("X-CSRF-TOKEN");return null==s?null:{header:u.getResponseHeader("X-CSRF-HEADER"),parameter:u.getResponseHeader("X-CSRF-PARAM"),token:s}},__createXhr:function(){return new XMLHttpRequest}};return n}),define("pentaho/lang/UserError",["./Base"],function(e){"use strict";return e.Error.extend("pentaho.lang.UserError",{get name(){return"UserError"}})}),define("pentaho/lang/RuntimeError",["module","./UserError"],function(e,t){"use strict";return t.extend(e.id,{get name(){return this.constructor.displayName}})}),define("pentaho/lang/Event",["./Base","../util/object","../util/error","./UserError"],function(e,t,n,r){"use strict";return e.extend("pentaho.lang.Event",{constructor:function(e,t,r){if(!e)throw n.argRequired("type");if(!t)throw n.argRequired("source");this.__type=e,this.__source=t,this.__cancelable=!!r},__cancelReason:null,__isCanceled:!1,get type(){return this.__type},get source(){return this.__source},get isCancelable(){return this.__cancelable},get cancelReason(){return this.__cancelReason},cancel:function(e){if(this.__cancelable&&!this.__isCanceled){if(e||(e="canceled"),"string"==typeof e)e=new r(e);else if(!(e instanceof Error))throw n.argInvalidType("reason",["string","Error"],typeof e);this.__cancelReason=e,this.__isCanceled=!0}},get isCanceled(){return this.__isCanceled},clone:function(){var e=Object.getPrototypeOf(this),n=Object.create(e);for(var r in this)if(this.hasOwnProperty(r)){var i=t.getPropertyDescriptor(this,r);Object.defineProperty(n,r,i)}return n}})}),define("pentaho/lang/EventSource",["module","./Base","./Event","../module/metaService","../util/error","../util/object","../util/fun","../util/logger"],function(e,t,n,r,i,o,u,s){"use strict";function a(e){this.dispose=e}function l(e){var t=this.__observersRegistry||(this.__observersRegistry={});return t[e]||(t[e]=c())}function c(){var e=[];return e.emittingLevel=0,e}function f(e,t,n,i){var o=r.get(e);null!==o&&(e=o.id);for(var u,s=l.call(this,e,!0),c=s.length;c--&&(u=s[c]).priority>=n;)u.index=c+1;return c++,s.emittingLevel&&(this.__observersRegistry[e]=s=s.slice(),s.emittingLevel=0),u={index:c,priority:n,observer:t,isCritical:i},s.splice(c,0,u),new a(h.bind(this,e,u))}function h(e,t){var n=this.__observersRegistry[e],r=t.index;n.emittingLevel&&(this.__observersRegistry[e]=n=n.slice(),n.emittingLevel=0),n.splice(r,1);var i=n.length;if(i)for(;r<i;)n[r].index=r,r++;else delete this.__observersRegistry[e]}function d(e){for(var t=0,n=e.length;t!==n;++t)e[t].dispose()}function p(e,t){var n=o.getOwn(this.__observersRegistry,e);if(n)for(var r=-1,i=n.length;++r<i;)if(n[r].observer.__===t)return n[r];return null}function _(e,t){var n=o.getOwn(this.__observersRegistry,e);if(n)for(var r=-1,i=n.length;++r<i;)if(n[r].observer===t)return n[r];return null}function g(e){return e instanceof Array?e:e.indexOf(",")>-1?e.split(/\s*,\s*/):[e]}function v(e){return e.isCanceled}function m(e,t,n,r){var i=n+("__"!==r?":"+r:""),o=e?" Error: "+e.message:"";s.log("Event listener of '"+i+"' failed."+o)}var y=Object.prototype.hasOwnProperty,b={isCanceled:v,errorHandler:null},w={isCanceled:v,errorHandler:m};return a.prototype.remove=function(){this.dispose()},t.extend(e.id,{__observersRegistry:null,on:function(e,t,n){if(!e)throw i.argRequired("type");if(!t)throw i.argRequired("observer");var r=g(e);if(r&&r.length){var o=n&&n.priority||0,s=!(!n||!n.isCritical);u.is(t)&&(t={__:t});var l=r.map(function(e){return f.call(this,e,t,o,s)},this);return l.length>1?new a(d.bind(this,l)):l[0]}return null},off:function(e,t){if(!e)throw i.argRequired("typeOrHandle");if(e instanceof a)return void e.dispose();if(!t)throw i.argRequired("observer");var n=g(e);if(n&&n.length){var o=u.is(t)?p:_;n.forEach(function(e){var n=r.get(e);null!==n&&(e=n.id);var i=o.call(this,e,t);i&&h.call(this,e,i)},this)}},_hasListeners:function(e,t){var n=r.get(e);null!==n&&(e=n.id);var i=o.getOwn(this.__observersRegistry,e,null);if(null!==i){if(!t)return!0;for(var u=-1,s=i.length;++u<s;)if(y.call(i[u].observer,t))return!0}return!1},_emit:function(e){if(!e)throw i.argRequired("event");if(!(e instanceof n))throw i.argInvalidType("event","pentaho.lang.Event");return this._emitGeneric(this,[e],e.type,null,b)?e:null},_emitSafe:function(e){if(!e)throw i.argRequired("event");if(!(e instanceof n))throw i.argInvalidType("event","pentaho.type.Event");return this._emitGeneric(this,[e],e.type,null,w)?e:null},_emitGeneric:function(e,t,n,u,s){if(!e)throw i.argRequired("source");if(!t)throw i.argRequired("eventArgs");if(!n)throw i.argRequired("type");var a;if((a=s&&s.isCanceled)&&a.apply(e,t))return!1;var l=r.get(n);null!==l&&(n=l.id);var c;if(null===(c=o.getOwn(this.__observersRegistry,n,null)))return!0;var f;u&&"__"!==u?f=u:(u=null,f="__");var h=s&&s.errorHandler;void 0===h&&(h=m);var d=s&&s.interceptor||null;c.emittingLevel++;try{var p,_=c.length;if(h){for(;_--;)if(p=c[_].observer[f]){try{null===d?p.apply(e,t):d(p,e,t,_)}catch(r){if(c[_].isCritical)throw r;h.call(e,r,t,n,u)}if(a&&a.apply(e,t))return!1}}else for(;_--;)if((p=c[_].observer[f])&&(null===d?p.apply(e,t):d(p,e,t,_),a&&a.apply(e,t)))return!1}finally{c.emittingLevel--}return!0},_emitGenericAllAsync:function(e,t,n,u,s){if(!e)throw i.argRequired("source");if(!t)throw i.argRequired("eventArgs");if(!n)throw i.argRequired("type");var a=s&&s.isCanceled,l=s&&s.getCancellationReason;if(a&&a.apply(e,t))return null!=l?Promise.reject(l.apply(e,t)):Promise.reject();var c=r.get(n);null!==c&&(n=c.id);var f;if(null===(f=o.getOwn(this.__observersRegistry,n,null)))return Promise.resolve();var h;u&&"__"!==u?h=u:(u=null,h="__");var d=s&&s.errorHandler;void 0===d&&(d=m),f.emittingLevel++;for(var p,_=[],g=f.length;g--;)null!=(p=f[g].observer[h])&&_.push(function(r){var i=new Promise(function(n){n(r.apply(e,t))});return null!==d&&(i=i.catch(function(r){return d.call(e,r,t,n,u)})),null!=a&&(i=i.then(function(){if(a.apply(e,t))return null!=l?Promise.reject(l.apply(e,t)):Promise.reject()})),i}(p));return f.emittingLevel--,Promise.all(_).then(function(){})}})}),define("pentaho/lang/Collection",["./List","../util/object"],function(e,t){return e.extend("pentaho.lang.Collection",{constructor:function(e){this.__keys={},this.base(e)},copyTo:function(e){this.base(e),t.assignOwn(e.__keys,this.__keys)},missingValue:null,elemClass:null,_getKeyName:function(){return this.elemClass?this.elemClass.prototype.keyName:"key"},_getElemKey:function(e){return e.key},
_sayElemWithKey:function(e){return"A "+this._getElemName()+" with "+this._getKeyName()+" '"+e+"'"},_sayElemCannotHaveNullyKey:function(){return"A "+this._getElemName()+" cannot have a nully "+this._getKeyName()+" value."},_adding:function(e,t,n){var r=this._cast(e,t,n);if(void 0!==r){var i=this._getElemKey(r);if(null==i)throw new Error(this._sayElemCannotHaveNullyKey());if(this.has(i))throw new Error(this._sayElemWithKey(i)+" is already included.")}return r},_replacing:function(e,t,n,r){var i=this._cast(e,t,r);if(void 0!==i){if(null==this._getElemKey(i))throw new Error(this._sayElemCannotHaveNullyKey())}return i},_added:function(e){this.__keys[this._getElemKey(e)]=e},_replaced:function(e){this.__keys[this._getElemKey(e)]=e},includes:function(e){if(e){var t=this._getElemKey(e);if(null!=t)return this.get(t)===e}return!1},has:function(e){var n;return null!=e&&null!=(n=this._castKey(e))&&t.hasOwn(this.__keys,n)},get:function(e,n){var r;if(null!=e&&null!=(r=this._castKey(e))&&t.hasOwn(this.__keys,r))return this.__keys[r];if(n)throw new Error(this._sayElemWithKey(r)+" is not defined.");return this.missingValue},getExisting:function(e){return this.get(e,!0)},_castKey:function(e){return e}})}),define("pentaho/util/date",[],function(){"use strict";function e(e){var t=i.exec(e);if(!t)return null;var n=[0,0];if(!t[1]){var r="+"===t[2]?1:-1;t[3]&&(n[0]=r*Number(t[3])),t[4]&&(n[1]=r*Number(t[4]))}return n}function t(e){var t=r.exec(e);return t?(e=[Number(t[1]),Number(t[2]),0,0],t[3]&&(e[2]=Number(t[3]),t[4]&&(e[3]=Number(t[4]))),e):null}var n=/^(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?(?:T([\d:\.]+))?([Z+\-][\d:]*)?$/,r=/^(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?$/,i=/^(?:(Z)|(?:([+\-])(\d{2}):(\d{2})))$/;return{parseDateEcma262v7:function(r){if(null==r)return null;switch(typeof r){case"number":return new Date(r);case"object":return r instanceof Date?r:null;case"string":break;default:return null}var i=n.exec(r);if(!i)return null;var o,u=[Number(i[1]),Number(i[2]||"1")-1,Number(i[3]||"1")];if(i[4]){if(!(o=t(i[4])))return null}else o=[0,0,0,0];var s,a=u.concat(o);if(i[5]){if(!(s=e(i[5])))return null;a[3]-=s[0],a[4]-=s[1]}else i[4]||(s=[0,0]);var l=s?new Date(Date.UTC(a[0],a[1],a[2],a[3],a[4],a[5],a[6])):new Date(a[0],a[1],a[2],a[3],a[4],a[5],a[6]);return isNaN(l.getTime())?null:l}}}),define("pentaho/platformCore",["pentaho/config/service","pentaho/module/service","pentaho/module/metaService","pentaho/module/metaOf","pentaho/module/subtypeOf","pentaho/module/subtypesOf","pentaho/module/instanceOf","pentaho/module/instancesOf","pentaho/i18n/MessageBundle","pentaho/i18n/LoadConfigAnnotation","pentaho/theme/main","pentaho/theme/LoadThemeAnnotation","pentaho/csrf/service","pentaho/lang/UserError","pentaho/lang/RuntimeError","pentaho/lang/Event","pentaho/lang/EventSource","pentaho/lang/Collection","pentaho/util/date"],function(){"use strict"});