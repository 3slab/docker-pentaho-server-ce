dojo.provide("dojox.secure.capability"),dojox.secure.badProps=/^__|^(apply|call|callee|caller|constructor|eval|prototype|this|unwatch|valueOf|watch)$|__$/,dojox.secure.capability={keywords:["break","case","catch","const","continue","debugger","default","delete","do","else","enum","false","finally","for","function","if","in","instanceof","new","null","yield","return","switch","throw","true","try","typeof","var","void","while"],validate:function(e,r,t){function o(e,r){var t={};return e.replace(/#\d+/g,function(e){var r=i[e.substring(1)];for(var o in r){if(o==l)throw o;"this"==o&&r[":method"]&&1==r.this&&(o=l),":method"!=o&&(t[o]=2)}}),e.replace(/(\W|^)([a-z_\$A-Z][\w_\$]*)/g,function(e,r,o){if("_"==o.charAt(0))throw new Error("Names may not start with _");t[o]=1}),t}function a(e,r,t,a,n,c){function s(e,r,t,o){o.replace(/,?([a-z\$A-Z][_\w\$]*)/g,function(e,r){if("Class"==r)throw new Error("Class is reserved");delete u[r]})}return c.replace(/(^|,)0:\s*function#(\d+)/g,function(e,r,t){i[t][":method"]=1}),c=c.replace(/(^|[^_\w\$])Class\s*\(\s*([_\w\$]+\s*,\s*)*#(\d+)/g,function(e,r,t,o){return delete i[o][l],(r||"")+(t||"")+"#"+o}),u=o(c,r),r&&s(e,t,t,n),c.replace(/(\W|^)(var) ([ \t,_\w\$]+)/g,s),(t||"")+(a||"")+"#"+(i.push(u)-1)}for(var n=this.keywords,c=0;c<n.length;c++)t[n[c]]=!0;var l="|this| keyword in object literal without a Class call",i=[];if(e.match(/[\u200c-\u200f\u202a-\u202e\u206a-\u206f\uff00-\uffff]/))throw new Error("Illegal unicode characters detected");if(e.match(/\/\*@cc_on/))throw new Error("Conditional compilation token is not allowed");e=e.replace(/\\["'\\\/bfnrtu]/g,"@").replace(/\/\/.*|\/\*[\w\W]*?\*\/|("[^"]*")|('[^']*')/g,function(e){return e.match(/^\/\/|^\/\*/)?" ":"0"}).replace(/\.\s*([a-z\$_A-Z][\w\$_]*)|([;,{])\s*([a-z\$_A-Z][\w\$_]*\s*):/g,function(e,r,t,o){if(r=r||o,/^__|^(apply|call|callee|caller|constructor|eval|prototype|this|unwatch|valueOf|watch)$|__$/.test(r))throw new Error("Illegal property name "+r);return t&&t+"0:"||"~"}),e.replace(/([^\[][\]\}]\s*=)|((\Wreturn|\S)\s*\[\s*\+?)|([^=!][=!]=[^=])/g,function(e){if(!e.match(/((\Wreturn|[=\&\|\:\?\,])\s*\[)|\[\s*\+$/))throw new Error("Illegal operator "+e.substring(1))}),e=e.replace(new RegExp("("+r.join("|")+")[\\s~]*\\(","g"),function(e){return"new("});var s,u;do{s=e.replace(/((function|catch)(\s+[_\w\$]+)?\s*\(([^\)]*)\)\s*)?{([^{}]*)}/g,a)}while(s!=e&&(e=s));a(0,0,0,0,0,e);for(c in u)if(!(c in t))throw new Error("Illegal reference to "+c)}};