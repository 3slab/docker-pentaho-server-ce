define(["../base64","./_base"],function(r,n){function a(r,n){for(var a=n.length/4-1,v=[[],[],[],[]],i=0;i<16;i++)v[i%4][Math.floor(i/4)]=r[i];v=f(v,n,0,4);for(var u=1;u<a;u++)v=o(v,4),v=e(v,4),v=t(v,4),v=f(v,n,u,4);v=o(v,4),v=e(v,4),v=f(v,n,a,4);for(var c=new Array(16),i=0;i<16;i++)c[i]=v[i%4][Math.floor(i/4)];return c}function o(r,n){for(var a=0;a<4;a++)for(var o=0;o<n;o++)r[a][o]=l[r[a][o]];return r}function e(r,n){for(var a=new Array(4),o=1;o<4;o++){for(var e=0;e<4;e++)a[e]=r[o][(e+o)%n];for(var e=0;e<4;e++)r[o][e]=a[e]}return r}function t(r,n){for(var a=0;a<4;a++){for(var o=new Array(4),e=new Array(4),t=0;t<4;t++)o[t]=r[t][a],e[t]=128&r[t][a]?r[t][a]<<1^283:r[t][a]<<1;r[0][a]=e[0]^o[1]^e[1]^o[2]^o[3],r[1][a]=o[0]^e[1]^o[2]^e[2]^o[3],r[2][a]=o[0]^o[1]^e[2]^o[3]^e[3],r[3][a]=o[0]^e[0]^o[1]^o[2]^e[3]}return r}function f(r,n,a,o){for(var e=0;e<4;e++)for(var t=0;t<o;t++)r[e][t]^=n[4*a+t][e];return r}function v(r){for(var n=r.length/4,a=n+6,o=new Array(4*(a+1)),e=new Array(4),t=0;t<n;t++){var f=[r[4*t],r[4*t+1],r[4*t+2],r[4*t+3]];o[t]=f}for(var t=n;t<4*(a+1);t++){o[t]=new Array(4);for(var v=0;v<4;v++)e[v]=o[t-1][v];if(t%n==0){e=i(u(e));for(var v=0;v<4;v++)e[v]^=w[t/n][v]}else n>6&&t%n==4&&(e=i(e));for(var v=0;v<4;v++)o[t][v]=o[t-n][v]^e[v]}return o}function i(r){for(var n=0;n<4;n++)r[n]=l[r[n]];return r}function u(r){r[4]=r[0];for(var n=0;n<4;n++)r[n]=r[n+1];return r}function c(r,n,o){if(128!=o&&192!=o&&256!=o)return"";for(var e=o/8,t=new Array(e),f=0;f<e;f++)t[f]=255&n.charCodeAt(f);var i=a(t,v(t));i=i.concat(i.slice(0,e-16));for(var u=new Array(16),c=(new Date).getTime(),f=0;f<4;f++)u[f]=c>>>8*f&255;for(var f=0;f<4;f++)u[f+4]=c/4294967296>>>8*f&255;for(var A=v(i),h=Math.ceil(r.length/16),l=new Array(h),w=0;w<h;w++){for(var y=0;y<4;y++)u[15-y]=w>>>8*y&255;for(var y=0;y<4;y++)u[15-y-4]=w/4294967296>>>8*y;for(var g=a(u,A),s=w<h-1?16:(r.length-1)%16+1,p="",f=0;f<s;f++){var d=r.charCodeAt(16*w+f),S=d^g[f];p+=(S<16?"0":"")+S.toString(16)}l[w]=p}for(var C="",f=0;f<8;f++)C+=(u[f]<16?"0":"")+u[f].toString(16);return C+" "+l.join(" ")}function A(r){var n=[];return r.replace(/(..)/g,function(r){n.push(parseInt(r,16))}),n}function h(r,n,o){if(128!=o&&192!=o&&256!=o)return"";for(var e=o/8,t=new Array(e),f=0;f<e;f++)t[f]=255&n.charCodeAt(f);var i=v(t),u=a(t,i);u=u.concat(u.slice(0,e-16));var c=v(u);r=r.split(" ");var h=new Array(16);h=A(r[0]);for(var l=new Array(r.length-1),w=1;w<r.length;w++){for(var y=0;y<4;y++)h[15-y]=w-1>>>8*y&255;for(var y=0;y<4;y++)h[15-y-4]=w/4294967296-1>>>8*y&255;for(var g=a(h,c),s="",p=A(r[w]),f=0;f<p.length;f++){var d=(r[w].charCodeAt(f),p[f]^g[f]);s+=String.fromCharCode(d)}l[w-1]=s}return l.join("")}var l=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],w=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];return n.SimpleAES=new function(){this.encrypt=function(r,n){return c(r,n,256)},this.decrypt=function(r,n){return h(r,n,256)}},n.SimpleAES});