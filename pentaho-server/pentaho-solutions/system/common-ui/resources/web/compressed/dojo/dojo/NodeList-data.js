define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(e,t,a,n,r){var o=t.NodeList,d={},i=0,f="data-dojo-dataid",u=function(e){var t=r.get(e,f);return t||(t="pid"+i++,r.set(e,f,t)),t},g=e._nodeData=function(e,t,n){var r,o=u(e);return d[o]||(d[o]={}),1==arguments.length&&(r=d[o]),"string"==typeof t?arguments.length>2?d[o][t]=n:r=d[o][t]:r=a.mixin(d[o],t),r},c=e._removeNodeData=function(e,t){var a=u(e);d[a]&&(t?delete d[a][t]:delete d[a])};return o._gcNodeData=e._gcNodeData=function(){var e=t("["+f+"]").map(u);for(var a in d)n.indexOf(e,a)<0&&delete d[a]},a.extend(o,{data:o._adaptWithCondition(g,function(e){return 0===e.length||1==e.length&&"string"==typeof e[0]}),removeData:o._adaptAsForEach(c)}),o});