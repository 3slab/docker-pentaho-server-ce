define(["dojo","../../util/oo","../../plugins/_Plugin","../../manager/_registry"],function(t,e,n,s){t.deprecated("dojox.drawing.ui.dom.Pan","It may not even make it to the 1.4 release.",1.4);var o=e.declare(n,function(e){this.domNode=e.node;var n;t.connect(this.domNode,"click",this,"onSetPan"),t.connect(this.keys,"onKeyUp",this,"onKeyUp"),t.connect(this.keys,"onKeyDown",this,"onKeyDown"),t.connect(this.anchors,"onAnchorUp",this,"checkBounds"),t.connect(this.stencils,"register",this,"checkBounds"),t.connect(this.canvas,"resize",this,"checkBounds"),t.connect(this.canvas,"setZoom",this,"checkBounds"),t.connect(this.canvas,"onScroll",this,function(){if(this._blockScroll)return void(this._blockScroll=!1);n&&clearTimeout(n),n=setTimeout(t.hitch(this,"checkBounds"),200)}),this._mouseHandle=this.mouse.register(this)},{selected:!1,type:"dojox.drawing.ui.dom.Pan",onKeyUp:function(t){32==t.keyCode&&this.onSetPan(!1)},onKeyDown:function(t){32==t.keyCode&&this.onSetPan(!0)},onSetPan:function(e){!0!==e&&!1!==e||(this.selected=!e),this.selected?(this.selected=!1,t.removeClass(this.domNode,"selected")):(this.selected=!0,t.addClass(this.domNode,"selected")),this.mouse.setEventMode(this.selected?"pan":"")},onPanDrag:function(t){t.x,t.last.x,t.y,t.last.y;this.canvas.domNode.parentNode.scrollTop-=t.move.y,this.canvas.domNode.parentNode.scrollLeft-=t.move.x,this.canvas.onScroll()},onStencilUp:function(t){this.checkBounds()},onStencilDrag:function(t){},checkBounds:function(){var t=1/0,e=-1/0,n=-1/0,s=1/0,o=0,i=0,c=this.stencils.group?this.stencils.group.getTransform():{dx:0,dy:0},a=this.mouse.scrollOffset(),h=(a.left,a.top,this.canvas.height),d=this.canvas.width,l=this.canvas.zoom,r=this.canvas.parentHeight,u=this.canvas.parentWidth;this.stencils.withSelected(function(o){var i=o.getBounds();t=Math.min(i.y1+c.dy,t),e=Math.max(i.x2+c.dx,e),n=Math.max(i.y2+c.dy,n),s=Math.min(i.x1+c.dx,s)}),this.stencils.withUnselected(function(o){var i=o.getBounds();t=Math.min(i.y1,t),e=Math.max(i.x2,e),n=Math.max(i.y2,n),s=Math.min(i.x1,s)}),n*=l;var m=0,p=0;a.top,n>r||a.top?(h=Math.max(n,r+a.top),i=a.top,m+=this.canvas.getScrollWidth()):!i&&h>r&&(h=r),e*=l,e>u||a.left?(d=Math.max(e,u+a.left),o=a.left,p+=this.canvas.getScrollWidth()):!o&&d>u&&(d=u),d+=2*m,h+=2*p,this._blockScroll=!0,this.stencils.group&&this.stencils.group.applyTransform({dx:0,dy:0}),this.stencils.withUnselected(function(t){t.transformPoints({dx:0,dy:0})}),this.canvas.setDimensions(d,h,o,i)}});return t.setObject("dojox.drawing.ui.dom.Pan",o),o.setup={name:"dojox.drawing.ui.dom.Pan",tooltip:"Pan Tool",iconClass:"iconPan"},s.register(o.setup,"plugin"),o});