define(["./_base"],function(){dojo.experimental("dojox.timing.ThreadPool");var t=dojox.timing;return t.threadStates={UNSTARTED:"unstarted",STOPPED:"stopped",PENDING:"pending",RUNNING:"running",SUSPENDED:"suspended",WAITING:"waiting",COMPLETE:"complete",ERROR:"error"},t.threadPriorities={LOWEST:1,BELOWNORMAL:2,NORMAL:3,ABOVENORMAL:4,HIGHEST:5},t.Thread=function(e,r){var i=this;this.state=t.threadStates.UNSTARTED,this.priority=r||t.threadPriorities.NORMAL,this.lastError=null,this.func=e,this.invoke=function(){i.state=t.threadStates.RUNNING;try{e(this),i.state=t.threadStates.COMPLETE}catch(e){i.lastError=e,i.state=t.threadStates.ERROR}}},t.ThreadPool=new function(e,r){var i=this,n=16,o=(Math.floor(156.25),[]),s=new Array(17),a=new dojox.timing.Timer;this.getMaxThreads=function(){return 16},this.getAvailableThreads=function(){return n},this.getTickInterval=function(){return 5e3},this.queueUserWorkItem=function(e){var r=e;r instanceof Function&&(r=new t.Thread(r));for(var i=o.length,n=0;n<o.length;n++)if(o[n].priority<r.priority){i=n;break}return i<o.length?o.splice(i,0,r):o.push(r),!0},this.removeQueuedUserWorkItem=function(t){if(t instanceof Function){for(var e=-1,r=0;r<o.length;r++)if(o[r].func==t){e=r;break}return e>-1&&(o.splice(e,1),!0)}for(var e=-1,r=0;r<o.length;r++)if(o[r]==t){e=r;break}return e>-1&&(o.splice(e,1),!0)},this.start=function(){a.start()},this.stop=function(){a.stop()},this.abort=function(){this.stop();for(var t=1;t<s.length;t++)s[t]&&window.clearTimeout(s[t]);for(var e in s[0])this.queueUserWorkItem(e);s[0]={}},this.reset=function(){this.abort(),o=[]},this.sleep=function(t){a.stop(),window.setTimeout(a.start,t)},a.onTick=i.invoke}(16,5e3),dojox.timing.ThreadPool});