define(["..","dojo/_base/lang","dojo/date/locale","dojo/i18n"],function(e,t,a,r){function o(e){return e=new Date(e),e.setHours(0,0,0,0),e}var l=t.getObject("date.relative",!0,e),n=dojo.delegate,c=a._getGregorianBundle,d=a.format;return l.format=function(e,t){t=t||{};var a=o(t.relativeDate||new Date),l=a.getTime()-o(e).getTime(),i={locale:t.locale};if(0===l)return d(e,n(i,{selector:"time"}));if(l<=5184e5&&l>0&&!1!==t.weekCheck)return d(e,n(i,{selector:"date",datePattern:"EEE"}))+" "+d(e,n(i,{selector:"time",formatLength:"short"}));if(e.getFullYear()==a.getFullYear()){var u=c(r.normalizeLocale(t.locale));return d(e,n(i,{selector:"date",datePattern:u["dateFormatItem-MMMd"]}))}return d(e,n(i,{selector:"date",formatLength:"medium",locale:t.locale}))},l});