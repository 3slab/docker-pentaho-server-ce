define(["dojo/_base/lang","dojo/_base/config","dojo/_base/array","dojo/has"],function(n,o,i,e){function t(n,o,i,e){return[[i.canConvertToLoggable||!i.declaredClass?i:i.declaredClass,e].join(":"),[n.canConvertToLoggable||!n.declaredClass?n:n.declaredClass,o].join(":")]}function a(o,i){return o===i||"number"==typeof o&&isNaN(o)&&"number"==typeof i&&isNaN(i)||n.isFunction((o||{}).getTime)&&n.isFunction((i||{}).getTime)&&o.getTime()==i.getTime()||(n.isFunction((o||{}).equals)?o.equals(i):!!n.isFunction((i||{}).equals)&&i.equals(o))}function s(o,a,s,r,c,l,g,u,d,f){if(!(s(d,u)||"*"==c&&i.indexOf(r.get("properties")||[g],g)<0||"*"==c&&g in(f||{}))){var v="*"==c?g:c;if(e("mvc-bindings-log-api"))var p=t(r,v,l,g);try{d=o?o(d,a):d}catch(n){return void(e("mvc-bindings-log-api")&&console.log("Copy from"+p.join(" to ")+" was not done as an error is thrown in the converter."))}e("mvc-bindings-log-api")&&console.log(p.reverse().join(" is being copied from: ")+" (Value: "+d+" from "+u+")"),n.isFunction(r.set)?r.set(v,d):r[v]=d}}var r=n.getObject("dojox.mvc",!0);e.add("mvc-bindings-log-api",(o.mvc||{}).debugBindings);var c;e("mvc-bindings-log-api");var l={from:1,to:2,both:3};return c=function(o,a,l,g,u){var d,f,v,p=(u||{}).converter;p&&(d={source:o,target:l},f=p.format&&n.hitch(d,p.format),v=p.parse&&n.hitch(d,p.parse));var m,b=[],h=[],j=n.mixin({},o.constraints,l.constraints),w=(u||{}).bindDirection||r.both,y=(u||{}).equals||c.equals;if(e("mvc-bindings-log-api"))var F=t(o,a,l,g);if("*"==g){if("*"!=a)throw new Error("Unmatched wildcard is specified between source and target.");if(!(m=l.get("properties"))){m=[];for(var C in l)l.hasOwnProperty(C)&&"_watchCallbacks"!=C&&m.push(C)}h=l.get("excludes")}else m=[a];w&r.from&&(n.isFunction(o.set)&&n.isFunction(o.watch)?b.push(o.watch.apply(o,("*"!=a?[a]:[]).concat([function(n,i,e){s(f,j,y,l,g,o,n,i,e,h)}]))):e("mvc-bindings-log-api")&&console.log(F.reverse().join(" is not a stateful property. Its change is not reflected to ")+"."),i.forEach(m,function(i){if("*"!=g||!(i in(h||{}))){var e=n.isFunction(o.get)?o.get(i):o[i];s(f,j,y,l,"*"==g?i:g,o,i,void 0,e)}})),w&r.to&&(w&r.from||i.forEach(m,function(i){if("*"!=g||!(i in(h||{}))){var e=n.isFunction(l.get)?l.get(g):l[g];s(v,j,y,o,i,l,"*"==g?i:g,void 0,e)}}),n.isFunction(l.set)&&n.isFunction(l.watch)?b.push(l.watch.apply(l,("*"!=g?[g]:[]).concat([function(n,i,e){s(v,j,y,o,a,l,n,i,e,h)}]))):e("mvc-bindings-log-api")&&console.log(F.join(" is not a stateful property. Its change is not reflected to ")+".")),e("mvc-bindings-log-api")&&console.log(F.join(" is bound to: "));var q={};return q.unwatch=q.remove=function(){for(var n=null;n=b.pop();)n.unwatch();e("mvc-bindings-log-api")&&console.log(F.join(" is unbound from: "))},q},n.mixin(r,l),n.setObject("dojox.mvc.sync",n.mixin(c,{equals:a},l))});