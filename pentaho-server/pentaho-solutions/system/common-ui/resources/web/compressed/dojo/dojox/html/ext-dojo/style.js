define(["dojo/_base/kernel","dojo/dom-style","dojo/_base/lang","dojo/_base/html","dojo/_base/sniff","dojo/_base/window","dojo/dom","dojo/dom-construct","dojo/dom-style","dojo/dom-attr"],function(t,r,e,a,o,s,n,i,l,f){t.experimental("dojox.html.ext-dojo.style");var m=(e.getObject("dojox.html.ext-dojo.style",!0),e.getObject("dojox.html"));return e.mixin(m["ext-dojo"].style,{supportsTransform:!0,_toPx:function(t){var r=a.style,e=this._conversion;return"number"==typeof t?t+"px":-1!=t.toLowerCase().indexOf("px")?t:(!e.parentNode&&i.place(e,s.body()),r(e,"margin",t),r(e,"margin"))},init:function(){var t=s.doc.documentElement.style,r=m["ext-dojo"].style,e=l.get,a=l.set;l.get=function(t,a){var o="transform"==a,s="transformOrigin"==a;return o?r.getTransform(t):s?r.getTransformOrigin(t):2==arguments.length?e(t,a):e(t)},l.set=function(t,e,o){var s="transform"==e,i="transformOrigin"==e,l=n.byId(t);return s?r.setTransform(l,o,!0):i?r.setTransformOrigin(l,o):3==arguments.length?a(l,e,o):a(l,e)};for(var f=0,d=["WebkitT","MozT","OT","msT","t"];f<d.length;f++)void 0!==t[d[f]+"ransform"]&&(this.tPropertyName=d[f]+"ransform"),void 0!==t[d[f]+"ransformOrigin"]&&(this.toPropertyName=d[f]+"ransformOrigin");this.tPropertyName?(this.setTransform=function(t,r){return a(t,this.tPropertyName,r)},this.getTransform=function(t){return e(t,this.tPropertyName)}):o("ie")&&(this.setTransform=this._setTransformFilter,this.getTransform=this._getTransformFilter),this.toPropertyName?(this.setTransformOrigin=function(t,r){return a(t,this.toPropertyName,r)},this.getTransformOrigin=function(t){return e(t,this.toPropertyName)}):o("ie")?(this.setTransformOrigin=this._setTransformOriginFilter,this.getTransformOrigin=this._getTransformOriginFilter):this.supportsTransform=!1,this._conversion=i.create("div",{style:{position:"absolute",top:"-100px",left:"-100px",fontSize:0,width:"0",backgroundPosition:"50% 50%"}})},_notSupported:function(){console.warn("Sorry, this browser doesn't support transform and transform-origin")},_setTransformOriginFilter:function(t,r){for(var o=e.trim(r).replace(" top"," 0").replace("left ","0 ").replace(" center","50%").replace("center ","50% ").replace(" bottom"," 100%").replace("right ","100% ").replace(/\s+/," "),s=o.split(" "),i=n.byId(t),l=this.getTransform(i),f=!0,m=0;m<s.length;m++)f=f&&/^0|(\d+(%|px|pt|in|pc|mm|cm))$/.test(s[m]),-1==s[m].indexOf("%")&&(s[m]=this._toPx(s[m]));return!f||!s.length||s.length>2?r:(a.attr(i,"dojo-transform-origin",s.join(" ")),l&&this.setTransform(t,l),r)},_getTransformOriginFilter:function(t){return a.attr(t,"dojo-transform-origin")||"50% 50%"},_setTransformFilter:function(t,r){var e=r.replace(/\s/g,""),s=n.byId(t),i=e.split(")"),l=1,m=1,d="DXImageTransform.Microsoft.Matrix",p=f.has,g=a.attr,c=Math.PI,h=Math.cos,x=Math.sin,u=Math.tan,y=Math.max,j=Math.min,b=Math.abs,T=c/180,O=c/200,I="",v=[],M=0,k=0,_=0,w=0,F=0,P=0,X=0,Y=1,N=0,z=0,S=1,D=0,L=0,B=[Y,N,z,S,D,L],C=!1,E=a.style,R="absolute"==E(s,"position")?"absolute":"relative",W=E(s,"width")+E(s,"paddingLeft")+E(s,"paddingRight"),$=E(s,"height")+E(s,"paddingTop")+E(s,"paddingBottom"),q=this._toPx;!p(s,"dojo-transform-origin")&&this.setTransformOrigin(s,"50% 50%");for(var A=0,G=i.length;A<G;A++){switch(v=i[A].match(/matrix|rotate|scaleX|scaleY|scale|skewX|skewY|skew|translateX|translateY|translate/),v?v[0]:""){case"matrix":I=i[A].replace(/matrix\(|\)/g,"");var H=I.split(",");Y=B[0]*H[0]+B[1]*H[2],N=B[0]*H[1]+B[1]*H[3],z=B[2]*H[0]+B[3]*H[2],S=B[2]*H[1]+B[3]*H[3],D=B[4]+H[4],L=B[5]+H[5];break;case"rotate":I=i[A].replace(/rotate\(|\)/g,""),l=-1!=I.indexOf("deg")?T:-1!=I.indexOf("grad")?O:1,X=parseFloat(I)*l;var J=x(X),K=h(X);Y=B[0]*K+B[1]*J,N=-B[0]*J+B[1]*K,z=B[2]*K+B[3]*J,S=-B[2]*J+B[3]*K;break;case"skewX":I=i[A].replace(/skewX\(|\)/g,""),l=-1!=I.indexOf("deg")?T:-1!=I.indexOf("grad")?O:1;var Q=u(parseFloat(I)*l);Y=B[0],N=B[0]*Q+B[1],z=B[2],S=B[2]*Q+B[3];break;case"skewY":I=i[A].replace(/skewY\(|\)/g,""),l=-1!=I.indexOf("deg")?T:-1!=I.indexOf("grad")?O:1,Q=u(parseFloat(I)*l),Y=B[0]+B[1]*Q,N=B[1],z=B[2]+B[3]*Q,S=B[3];break;case"skew":I=i[A].replace(/skew\(|\)/g,"");var U=I.split(",");U[1]=U[1]||"0",l=-1!=U[0].indexOf("deg")?T:-1!=U[0].indexOf("grad")?O:1,m=-1!=U[1].indexOf("deg")?T:-1!=U[1].indexOf("grad")?O:1;var V=u(parseFloat(U[0])*l),Z=u(parseFloat(U[1])*m);Y=B[0]+B[1]*Z,N=B[0]*V+B[1],z=B[2]+B[3]*Z,S=B[2]*V+B[3];break;case"scaleX":I=parseFloat(i[A].replace(/scaleX\(|\)/g,""))||1,Y=B[0]*I,N=B[1],z=B[2]*I,S=B[3];break;case"scaleY":I=parseFloat(i[A].replace(/scaleY\(|\)/g,""))||1,Y=B[0],N=B[1]*I,z=B[2],S=B[3]*I;break;case"scale":I=i[A].replace(/scale\(|\)/g,"");var tt=I.split(",");tt[1]=tt[1]||tt[0],Y=B[0]*tt[0],N=B[1]*tt[1],z=B[2]*tt[0],S=B[3]*tt[1];break;case"translateX":I=parseInt(i[A].replace(/translateX\(|\)/g,""))||1,Y=B[0],N=B[1],z=B[2],S=B[3],D=q(I),D&&g(s,"dojo-transform-matrix-tx",D);break;case"translateY":I=parseInt(i[A].replace(/translateY\(|\)/g,""))||1,Y=B[0],N=B[1],z=B[2],S=B[3],L=q(I),L&&g(s,"dojo-transform-matrix-ty",L);break;case"translate":I=i[A].replace(/translate\(|\)/g,""),Y=B[0],N=B[1],z=B[2],S=B[3];var rt=I.split(",");rt[0]=parseInt(q(rt[0]))||0,rt[1]=parseInt(q(rt[1]))||0,D=rt[0],L=rt[1],D&&g(s,"dojo-transform-matrix-tx",D),L&&g(s,"dojo-transform-matrix-ty",L)}B=[Y,N,z,S,D,L]}var et=j(W*Y+$*N,j(j(W*Y,$*N),0)),at=j(W*z+$*S,j(j(W*z,$*S),0));if(_=-et,w=-at,o("ie")<8){if(s.style.zoom="1","absolute"!=R){var ot=E(t.parentNode,"width"),st=b(W*Y),nt=b($*N),it=y(st+nt,y(y(nt,st),0));_-=(it-W)/2-(ot>it?0:(it-ot)/2)}}else 8==o("ie")&&"auto"==E(s,"zIndex")&&(s.style.zIndex="0");try{C=!!s.filters.item(d)}catch(t){C=!1}C?(s.filters.item(d).M11=Y,s.filters.item(d).M12=N,s.filters.item(d).M21=z,s.filters.item(d).M22=S,s.filters.item(d).filterType="bilinear",s.filters.item(d).Dx=0,s.filters.item(d).Dy=0,s.filters.item(d).sizingMethod="auto expand"):s.style.filter+=" progid:"+d+"(M11="+Y+",M12="+N+",M21="+z+",M22="+S+",FilterType='bilinear',Dx=0,Dy=0,sizingMethod='auto expand')",D=parseInt(g(s,"dojo-transform-matrix-tx")||"0"),L=parseInt(g(s,"dojo-transform-matrix-ty")||"0");var lt=g(s,"dojo-transform-origin").split(" ");for(A=0;A<2;A++)lt[A]=lt[A]||"50%";return F=-1!=lt[0].toString().indexOf("%")?W*parseInt(lt[0])*.01:lt[0],P=-1!=lt[1].toString().indexOf("%")?$*parseInt(lt[1])*.01:lt[1],p(s,"dojo-startX")?M=parseInt(g(s,"dojo-startX")):(M=parseInt(E(s,"left")),g(s,"dojo-startX","absolute"==R?M:"0")),p(s,"dojo-startY")?k=parseInt(g(s,"dojo-startY")):(k=parseInt(E(s,"top")),g(s,"dojo-startY","absolute"==R?k:"0")),E(s,{position:R,left:M-parseInt(_)+parseInt(F)-((parseInt(F)-D)*Y+(parseInt(P)-L)*N)+"px",top:k-parseInt(w)+parseInt(P)-((parseInt(F)-D)*z+(parseInt(P)-L)*S)+"px"}),r},_getTransformFilter:function(t){try{var r=n.byId(t),e=r.filters.item(0);return"matrix("+e.M11+", "+e.M12+", "+e.M21+", "+e.M22+", "+(a.attr(t,"dojo-transform-tx")||"0")+", "+(a.attr(t,"dojo-transform-ty")||"0")+")"}catch(t){return"matrix(1, 0, 0, 1, 0, 0)"}},setTransform:function(){this._notSupported()},setTransformOrigin:function(){this._notSupported()}}),m["ext-dojo"].style.init(),a.style});