define(["dojo/_base/window","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom-attr","dojo/dom-class","dijit/_base/manager","dijit/_Widget","dijit/form/_FormWidget","dijit/form/Button","dijit/form/CheckBox","dojo/_base/declare"],function(t,i,e,n,s,o,r,c,a,h,d,f){var g=i.getObject("dojox.form.manager",!0),u=g.actionAdapter=function(t){return function(n,s,o){i.isArray(s)?e.forEach(s,function(i){t.call(this,n,i,o)},this):t.apply(this,arguments)}},l=(g.inspectorAdapter=function(t){return function(e,n,s){return t.call(this,e,i.isArray(n)?n[0]:n,s)}},{domNode:1,containerNode:1,srcNodeRef:1,bgIframe:1}),m=g._keys=function(t){var i,e=[];for(i in t)t.hasOwnProperty(i)&&e.push(i);return e},N=function(t){var e=t.get("name");if(e&&t.isInstanceOf(a))if(e in this.formWidgets){var n=this.formWidgets[e].widget;i.isArray(n)?n.push(t):this.formWidgets[e].widget=[n,t]}else this.formWidgets[e]={widget:t,connections:[]};else e=null;return e},v=function(t){var n={};return u(function(t,s){var o=s.get("data-dojo-observer")||s.get("observer");o&&"string"==typeof o&&e.forEach(o.split(","),function(t){(t=i.trim(t))&&i.isFunction(this[t])&&(n[t]=1)},this)}).call(this,null,this.formWidgets[t].widget),m(n)},W=function(t,o){var r=this.formWidgets[t],c=r.widget,a=r.connections;if(a.length&&(e.forEach(a,function(t){t.remove()}),a=r.connections=[]),i.isArray(c))e.forEach(c,function(r){e.forEach(o,function(e){a.push(n(r,"change",i.hitch(this,function(i){this.watching&&s.get(r.focusNode,"checked")&&this[e](r.get("value"),t,r,i)})))},this)},this);else{var d=c.isInstanceOf(h)?"click":"change";e.forEach(o,function(e){a.push(n(c,d,i.hitch(this,function(i){this.watching&&this[e](c.get("value"),t,c,i)})))},this)}},p=f("dojox.form.manager._Mixin",null,{watching:!0,startup:function(){this._started||(this.formWidgets={},this.formNodes={},this.registerWidgetDescendants(this),this.inherited(arguments))},destroy:function(){for(var t in this.formWidgets)e.forEach(this.formWidgets[t].connections,function(t){t.remove()});this.formWidgets={},this.inherited(arguments)},registerWidget:function(t){"string"==typeof t?t=r.byId(t):t.tagName&&t.cloneNode&&(t=r.byNode(t));var i=N.call(this,t);return i&&W.call(this,i,v.call(this,i)),this},unregisterWidget:function(t){return t in this.formWidgets&&(e.forEach(this.formWidgets[t].connections,function(t){t.remove()}),delete this.formWidgets[t]),this},registerWidgetDescendants:function(t){"string"==typeof t?t=r.byId(t):t.tagName&&t.cloneNode&&(t=r.byNode(t));var i=e.map(t.getDescendants(),N,this);return e.forEach(i,function(t){t&&W.call(this,t,v.call(this,t))},this),this.registerNodeDescendants?this.registerNodeDescendants(t.domNode):this},unregisterWidgetDescendants:function(t){return"string"==typeof t?t=r.byId(t):t.tagName&&t.cloneNode&&(t=r.byNode(t)),e.forEach(e.map(t.getDescendants(),function(t){return t instanceof a&&t.get("name")||null}),function(t){t&&this.unregisterWidget(t)},this),this.unregisterNodeDescendants?this.unregisterNodeDescendants(t.domNode):this},formWidgetValue:function(t,n){var o,r=2==arguments.length&&void 0!==n;return"string"==typeof t&&(t=this.formWidgets[t])&&(t=t.widget),t?i.isArray(t)?r?(e.forEach(t,function(t){t.set("checked",!1,!this.watching)},this),e.forEach(t,function(t){t.set("checked",t.value===n,!this.watching)},this),this):(e.some(t,function(t){return!!s.get(t.focusNode,"checked")&&(o=t,!0)}),o?o.get("value"):""):t.isInstanceOf&&t.isInstanceOf(d)?r?(t.set("value",Boolean(n),!this.watching),this):Boolean(t.get("value")):r?(t.set("value",n,!this.watching),this):t.get("value"):null},formPointValue:function(t,i){return t&&"string"==typeof t&&(t=this[t]),t&&t.tagName&&t.cloneNode&&o.contains(t,"dojoFormValue")?2==arguments.length&&void 0!==i?(t.innerHTML=i,this):t.innerHTML:null},inspectFormWidgets:function(t,n,s){var o,r={};if(n)if(i.isArray(n))e.forEach(n,function(i){i in this.formWidgets&&(r[i]=t.call(this,i,this.formWidgets[i].widget,s))},this);else for(o in n)o in this.formWidgets&&(r[o]=t.call(this,o,this.formWidgets[o].widget,n[o]));else for(o in this.formWidgets)r[o]=t.call(this,o,this.formWidgets[o].widget,s);return r},inspectAttachedPoints:function(t,n,s){var o,r,c={};if(n)if(i.isArray(n))e.forEach(n,function(i){(r=this[i])&&r.tagName&&r.cloneNode&&(c[i]=t.call(this,i,r,s))},this);else for(o in n)(r=this[o])&&r.tagName&&r.cloneNode&&(c[o]=t.call(this,o,r,n[o]));else for(o in this)o in l||(r=this[o])&&r.tagName&&r.cloneNode&&(c[o]=t.call(this,o,r,s));return c},inspect:function(t,n,s){var o=this.inspectFormWidgets(function(n,s,o){return i.isArray(s)?t.call(this,n,e.map(s,function(t){return t.domNode}),o):t.call(this,n,s.domNode,o)},n,s);return this.inspectFormNodes&&i.mixin(o,this.inspectFormNodes(t,n,s)),i.mixin(o,this.inspectAttachedPoints(t,n,s))}});return i.extend(c,{observer:""}),p});